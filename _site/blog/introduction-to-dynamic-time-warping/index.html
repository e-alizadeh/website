<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.203">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Esmaeil Alizadeh">
<meta name="dcterms.date" content="2020-10-11">

<title>Essi Alizadeh - An Illustrative Introduction to Dynamic Time Warping</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../assets/favicon.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

<script type="text/javascript">

(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-180647948-1', 'auto');

ga('send', {
  hitType: 'pageview',
  'anonymizeIp': true,
});
</script>
<style>html{ scroll-behavior: smooth; }</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">

<link rel="stylesheet" href="../../styles.css">
<meta property="og:title" content="Essi Alizadeh - An Illustrative Introduction to Dynamic Time Warping">
<meta property="og:description" content="+ math behind it">
<meta property="og:image" content="https://new.ealizadeh.com/blog/introduction-to-dynamic-time-warping/img/bp02_featured_image.png">
<meta property="og:site-name" content="Essi Alizadeh">
<meta property="og:image:height" content="753">
<meta property="og:image:width" content="1024">
<meta name="twitter:title" content="Essi Alizadeh - An Illustrative Introduction to Dynamic Time Warping">
<meta name="twitter:description" content="+ math behind it">
<meta name="twitter:image" content="https://new.ealizadeh.com/blog/introduction-to-dynamic-time-warping/img/bp02_featured_image.png">
<meta name="twitter:creator" content="@es_alizadeh">
<meta name="twitter:site" content="@es_alizadeh">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image-height" content="753">
<meta name="twitter:image-width" content="1024">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Essi Alizadeh</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blog.html">
 <span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../contact_me.html">
 <span class="menu-text">Contact me</span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">An Illustrative Introduction to Dynamic Time Warping</h1>
            <p class="subtitle lead">+ math behind it</p>
                                <div class="quarto-categories">
                <div class="quarto-category">Getting Started</div>
                <div class="quarto-category">Pattern Recognition</div>
                <div class="quarto-category">Python</div>
                <div class="quarto-category">Time Series Analysis</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Esmaeil Alizadeh </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">October 11, 2020</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#formulation" id="toc-formulation" class="nav-link active" data-scroll-target="#formulation">Formulation</a>
  <ul>
  <li><a href="#warping-path-and-dtw-distance" id="toc-warping-path-and-dtw-distance" class="nav-link" data-scroll-target="#warping-path-and-dtw-distance">Warping Path and DTW distance</a></li>
  </ul></li>
  <li><a href="#restrictions-on-the-warping-function" id="toc-restrictions-on-the-warping-function" class="nav-link" data-scroll-target="#restrictions-on-the-warping-function">Restrictions on the Warping function</a></li>
  <li><a href="#implementation" id="toc-implementation" class="nav-link" data-scroll-target="#implementation">Implementation</a></li>
  <li><a href="#example-1" id="toc-example-1" class="nav-link" data-scroll-target="#example-1">Example 1</a>
  <ul>
  <li><a href="#compute-dtw-distance-and-warp-path" id="toc-compute-dtw-distance-and-warp-path" class="nav-link" data-scroll-target="#compute-dtw-distance-and-warp-path">Compute DTW distance and warp&nbsp;path</a></li>
  </ul></li>
  <li><a href="#example-2" id="toc-example-2" class="nav-link" data-scroll-target="#example-2">Example 2</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  <li><a href="#useful-links" id="toc-useful-links" class="nav-link" data-scroll-target="#useful-links">Useful Links</a></li>
  </ul>
</nav>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar"><div class="quarto-margin-header"><div class="margin-header-item">
<!-- Main CSS style -->
<style type="text/css" media="screen">
    #mailchimp {
   /* background: #F7F9FB; */
   color: #595c5f;
   /* padding: 20px 15px; */
}
   #mailchimp input {
   border-width: 2px;
   border-style: solid;
   border-color: gray;
   color: gray;
   font-family: Arial, Helvetica, sans-serif;
   font-size: 14px;
   /*font-style: italic;*/
   margin-bottom: 10px;
   padding: 8px 10px;
   /* width: 275px; */
    border-radius: 15px;
    -moz-border-radius: 15px;
    -webkit-border-radius: 15px;
   }
   #mailchimp input.email { background: #fff; padding: 10px; text-align: left;}
   #mailchimp input.name { background: #fff; padding: 10px; text-align: left;}
   #mailchimp input[type="submit"] {
       background: #8FC1E3;
       border: none;
       color: #fff;
       cursor: pointer;
       font-size: 15px;
       margin-top: -2px;
       /* width: 55%; */
       /* padding: 8px 0; */
   }
   #mailchimp input[type="submit"]:hover { background: #99DDFF; color: #fff }
   
   .mailinglist{
       color: #595c5f;
       text-align: left;
       font-size: 18px;
       font-weight: bold;
       font-family: Arial, Helvetica, sans-serif;
       /* padding-left: 2.0em; */
       padding-bottom: 3px;
   }

   .footnote {
       color: grey;
       font-family: Arial, Helvetica, sans-serif;
       font-size: 12px;
       margin-top: -3px;
       padding-left: 1.5em;
       }
   /* Errors */
   .error {
   border-color: red;
   }

   .error-message {
        color: red;
        font-style: italic;
        font-size: 12px;
        margin-top: -4px;
        margin-bottom: 3px;
        padding-left: 1.5em;
    }
</style>


<!-- Begin Integrating Email Constraint Validation using a JavaScript API -->
<script>
   // Add the novalidate attribute when the JS loads
   var forms = document.querySelectorAll('.validate');
   for (var i = 0; i < forms.length; i++) {
       forms[i].setAttribute('novalidate', true);
   }


   // Validate the field
   var hasError = function (field) {

       // Don't validate submits, buttons, file and reset inputs, and disabled fields
       if (field.disabled || field.type === 'file' || field.type === 'reset' || field.type === 'submit' || field.type === 'button') return;

       // Get validity
       var validity = field.validity;

       // If valid, return null
       if (validity.valid) return;

       // If field is required and empty
       if (validity.valueMissing) return 'Please fill out this field.';

       // If not the right type
       if (validity.typeMismatch) {

           // Email
           if (field.type === 'email') return 'Please enter an email address.';

           // URL
           if (field.type === 'url') return 'Please enter a URL.';

       }

       // If too short
       if (validity.tooShort) return 'Please lengthen this text to ' + field.getAttribute('minLength') + ' characters or more. You are currently using ' + field.value.length + ' characters.';

       // If too long
       if (validity.tooLong) return 'Please shorten this text to no more than ' + field.getAttribute('maxLength') + ' characters. You are currently using ' + field.value.length + ' characters.';

       // If pattern doesn't match
       if (validity.patternMismatch) {

           // If pattern info is included, return custom error
           if (field.hasAttribute('title')) return field.getAttribute('title');

           // Otherwise, generic error
           return 'Please match the requested format.';

       }

       // If number input isn't a number
       if (validity.badInput) return 'Please enter a number.';

       // If a number value doesn't match the step interval
       if (validity.stepMismatch) return 'Please select a valid value.';

       // If a number field is over the max
       if (validity.rangeOverflow) return 'Please select a value that is no more than ' + field.getAttribute('max') + '.';

       // If a number field is below the min
       if (validity.rangeUnderflow) return 'Please select a value that is no less than ' + field.getAttribute('min') + '.';

       // If all else fails, return a generic catchall error
       return 'The value you entered for this field is invalid.';

   };


   // Show an error message
   var showError = function (field, error) {

       // Add error class to field
       field.classList.add('error');
   
       // If the field is a radio button and part of a group, error all and get the last item in the group
       if (field.type === 'radio' && field.name) {
           var group = field.form.querySelectorAll('[name="' + field.name + '"]');
           if (group.length > 0) {
               for (var i = 0; i < group.length; i++) {
                   group[i].classList.add('error');
               }
               field = group[group.length - 1];
           }
       }

       // Get field id or name
       var id = field.id || field.name;
       if (!id) return;

       // Check if error message field already exists
       // If not, create one
       var message = field.form.querySelector('.error-message#error-for-' + id );
       if (!message) {
           message = document.createElement('div');
           message.className = 'error-message';
           message.id = 'error-for-' + id;
           
           // If the field is a radio button or checkbox, insert error after the label
           var label;
           if (field.type === 'radio' || field.type ==='checkbox') {
               label = field.form.querySelector('label[for="' + id + '"]') || field.parentNode;
               if (label) {
                   label.parentNode.insertBefore( message, label.nextSibling );
               }
           }

           // Otherwise, insert it after the field
           if (!label) {
               field.parentNode.insertBefore( message, field.nextSibling );
           }

       }
       
       // Add ARIA role to the field
       field.setAttribute('aria-describedby', 'error-for-' + id);

       // Update error message
       message.innerHTML = error;

       // Show error message
       message.style.display = 'block';
       message.style.visibility = 'visible';

   };


   // Remove the error message
   var removeError = function (field) {

       // Remove error class to field
       field.classList.remove('error');
       
       // Remove ARIA role from the field
       field.removeAttribute('aria-describedby');

       // If the field is a radio button and part of a group, remove error from all and get the last item in the group
       if (field.type === 'radio' && field.name) {
           var group = field.form.querySelectorAll('[name="' + field.name + '"]');
           if (group.length > 0) {
               for (var i = 0; i < group.length; i++) {
                   group[i].classList.remove('error');
               }
               field = group[group.length - 1];
           }
       }

       // Get field id or name
       var id = field.id || field.name;
       if (!id) return;
       

       // Check if an error message is in the DOM
       var message = field.form.querySelector('.error-message#error-for-' + id + '');
       if (!message) return;

       // If so, hide it
       message.innerHTML = '';
       message.style.display = 'none';
       message.style.visibility = 'hidden';

   };


   // Listen to all blur events
   document.addEventListener('blur', function (event) {

       // Only run if the field is in a form to be validated
       if (!event.target.form.classList.contains('validate')) return;

       // Validate the field
       var error = hasError(event.target);
   
       // If there's an error, show it
       if (error) {
           showError(event.target, error);
           return;
       }

       // Otherwise, remove any existing error message
       removeError(event.target);

   }, true);


   // Check all fields on submit
   document.addEventListener('submit', function (event) {

       // Only run on forms flagged for validation
       if (!event.target.classList.contains('validate')) return;

       // Get all of the form elements
       var fields = event.target.elements;

       // Validate each field
       // Store the first field with an error to a variable so we can bring it into focus later
       var error, hasErrors;
       for (var i = 0; i < fields.length; i++) {
           error = hasError(fields[i]);
           if (error) {
               showError(fields[i], error);
               if (!hasErrors) {
                   hasErrors = fields[i];
               }
           }
       }

       // If there are errrors, don't submit form and focus on first element with error
       if (hasErrors) {
           event.preventDefault();
           hasErrors.focus();
       }

       // Otherwise, let the form submit normally
       // You could also bolt in an Ajax form submit process here

   }, false);
</script>
<!-- End of JavaScript Email Constraint Validation -->


<!-- Begin MailChimp Signup Form -->
<div id="mailchimp">
   <form action="https://ealizadeh.us10.list-manage.com/subscribe/post?u=912b9dacf23679bd0a6e46b22&amp;id=31485d9fc5" method="post" id="mc-embedded-subscribe-form" class="validate" style="max-width:450px;margin:auto" name="mc-embedded-subscribe-form" target="_blank" novalidate="">
       <!-- <i class="fa fa-envelope icon"> </i> -->    
       <h3 aria-hidden="true" class="fas fa-paper-plane mailinglist">Mailing List</h3>
           <!-- <div class="input-icons">  -->
                       <!-- <div class="input-icons">  -->
           <div class="clear">
               <i class="fa fa-envelope"> </i>
               <input class="required email" type="email" size="17" placeholder="E-mail Address" name="EMAIL" id="mce-EMAIL" title="The domain portion of the email address is invalid (the portion after the @)." pattern="^([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x22([^\x0d\x22\x5c\x80-\xff]|\x5c[\x00-\x7f])*\x22)(\x2e([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x22([^\x0d\x22\x5c\x80-\xff]|\x5c[\x00-\x7f])*\x22))*\x40([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x5b([^\x0d\x5b-\x5d\x80-\xff]|\x5c[\x00-\x7f])*\x5d)(\x2e([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x5b([^\x0d\x5b-\x5d\x80-\xff]|\x5c[\x00-\x7f])*\x5d))*(\.\w{2,})+$" required="">
           </div>
           <div class="clear">
               <i class="fa fa-user"> </i> 
               <input class="name" type="text" size="17" placeholder="Name (Optional)" name="FNAME" id="mce-FNAME">
           </div>

           <!-- <div class="footnote"> -->
               <p class="footnote"> No Spam. Unsubscribe anytime.</p>
           <!-- </div> -->
       <div id="mce-responses" class="clear">
           <div class="response" id="mce-error-response" style="display:none"></div>
           <div class="response" id="mce-success-response" style="display:none"></div>
       </div>
       
       <!-- <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_f2d244c0df42a0431bd08ddea_aeaa9dd034" tabindex="-1" value=""></div> -->
       <div class="clear">
           <input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button">
       </div>
   </form>
</div>
<!--End of MailChimp Signup Form-->
</div></div>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<p><img src="img/bp02_featured_image.png" class="img-fluid" alt="Featured image of the post"></p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>üëâ This article is also published on&nbsp;<a href="https://towardsdatascience.com/an-illustrative-introduction-to-dynamic-time-warping-36aa98513b98"><strong>Towards Data Science blog</strong></a>.</p>
</div>
</div>
<p>Dynamic Time Warping (DTW) is a way to compare two -usually temporal- sequences that do not sync up perfectly. It is a method to calculate the optimal matching between two sequences. DTW is useful in many domains such as speech recognition, data mining, financial markets, etc. It‚Äôs commonly used in data mining to measure the distance between two time-series.</p>
<p>In this post, we will go over the mathematics behind DTW. Then, two illustrative examples are provided to better understand the concept. If you are not interested in the math behind it, please jump to examples.</p>
<section id="formulation" class="level2">
<h2 class="anchored" data-anchor-id="formulation">Formulation</h2>
<p>Let‚Äôs assume we have two sequences like the following:</p>
<p><span class="math display">
    X=x_1,x_2,...,x_i,...,x_n \\
    Y=y_1,y_2,...,y_j,...,y_m
</span></p>
<p>The sequences <span class="math inline">X</span> and <span class="math inline">Y</span> can be arranged to form an <span class="math inline">n \text{-by-} m</span> grid, where each point <span class="math inline">(i, j)</span> is the alignment between <span class="math inline">x_i</span> and <span class="math inline">y_j</span>.</p>
<p>A warping path <span class="math inline">W</span> maps the elements of <span class="math inline">X</span> and <span class="math inline">Y</span> to minimize the <em>distance</em> between them. <span class="math inline">W</span> is a sequence of grid points <span class="math inline">(i,j)</span>. We will see an example of the warping path later.</p>
<section id="warping-path-and-dtw-distance" class="level3">
<h3 class="anchored" data-anchor-id="warping-path-and-dtw-distance">Warping Path and DTW distance</h3>
<p>The Optimal path to <span class="math inline">(i_k,j_k)</span> can be computed by:</p>
<p><span class="math display">
D_\text{min}(i_k,j_k) = \min_{i_{k‚àí1},\;j_{k‚àí1}} D_\text{min}(i_{k‚àí1},j_{k‚àí1}) + d(i_k,j_k‚à£i_{k‚àí1},j_{k‚àí1})
</span></p>
<p>where <span class="math inline">d</span> is the Euclidean distance <span class="math inline">d(i,j)=‚à£‚à£f_1‚Äã(i)‚àíf_2‚Äã(j)‚à£‚à£</span></p>
<p>Overall path cost: <span class="math inline">D=\sum_k d(i_k,j_k)</span></p>
</section>
</section>
<section id="restrictions-on-the-warping-function" class="level2">
<h2 class="anchored" data-anchor-id="restrictions-on-the-warping-function">Restrictions on the Warping function</h2>
<p>The warping path is found using a dynamic programming approach to align two sequences. Going through all possible paths is ‚Äúcombinatorically explosive‚Äù<span class="citation" data-cites="berndt1994dtw">(see <a href="#ref-berndt1994dtw" role="doc-biblioref">Berndt and Clifford 1994</a>)</span>. Therefore, for efficiency purposes, it‚Äôs important to limit the number of possible warping paths, and hence the following constraints are outlined:</p>
<ul>
<li><strong>Boundary Condition:</strong> This constraint ensures that the warping path begins with the start points of both signals and terminates with their endpoints.</li>
</ul>
<p><span class="math display">
i_1=1, \; i_k=n \quad \text{and} \quad  j_1=1, \; j_k=m
</span></p>
<ul>
<li><strong>Monotonicity condition:</strong> This constraint preserves the time-order of points (not going back in time).</li>
</ul>
<p><span class="math display">
i_{t-1} \le i_t \quad \text{and} \quad  j_{t-1} \le j_t
</span></p>
<ul>
<li><strong>Continuity (step size) condition:</strong> This constraint limits the path transitions to adjacent points in time (not jumping in time).</li>
</ul>
<p><span class="math display">
i_t - i_{t-1} \le 1 \quad \text{and} \quad  j_t - j_{t-1} \le 1
</span></p>
<p>In addition to the above three constraints, there are other less frequent conditions for an allowable warping path:</p>
<ul>
<li><strong>Warping window condition:</strong> Allowable points can be restricted to fall within a given warping window of width <span class="math inline">\omega</span> (a positive integer).</li>
</ul>
<p><span class="math display">
|i_t - j_t| \le \omega
</span></p>
<ul>
<li><strong>Slope condition:</strong> The warping path can be constrained by restricting the slope, and consequently avoiding extreme movements in one direction.</li>
</ul>
<p>An acceptable warping path has combinations of <strong>chess king</strong> moves that are:</p>
<ul>
<li>Horizontal moves:&nbsp;<span class="math inline">(i, j) \rightarrow (i, j+1)</span></li>
<li>Vertical moves:&nbsp;<span class="math inline">(i, j) \rightarrow (i+1, j)</span></li>
<li>Diagonal moves:&nbsp;<span class="math inline">(i, j) \rightarrow (i+1, j+1)</span></li>
</ul>
</section>
<section id="implementation" class="level2">
<h2 class="anchored" data-anchor-id="implementation">Implementation</h2>
<p>Let‚Äôs import all python packages we need.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting Packages</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sbn</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib <span class="im">as</span> mpl</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>mpl.rcParams[<span class="st">'figure.dpi'</span>] <span class="op">=</span> <span class="dv">300</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>savefig_options <span class="op">=</span> <span class="bu">dict</span>(<span class="bu">format</span><span class="op">=</span><span class="st">"png"</span>, dpi<span class="op">=</span><span class="dv">300</span>, bbox_inches<span class="op">=</span><span class="st">"tight"</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Computation packages</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.spatial.distance <span class="im">import</span> euclidean</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fastdtw <span class="im">import</span> fastdtw</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Let‚Äôs define a method to compute the accumulated cost matrix <span class="math inline">D</span> for the warp path. The cost matrix uses the Euclidean distance to calculate the distance between every two points. The methods to compute the Euclidean distance matrix and accumulated cost matrix are defined below:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> compute_euclidean_distance_matrix(x, y) <span class="op">-&gt;</span> np.array:</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Calculate distance matrix</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co">    This method calcualtes the pairwise Euclidean distance between two sequences.</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co">    The sequences can have different lengths.</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    dist <span class="op">=</span> np.zeros((<span class="bu">len</span>(y), <span class="bu">len</span>(x)))</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(y)):</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(x)):</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>            dist[i,j] <span class="op">=</span> (x[j]<span class="op">-</span>y[i])<span class="op">**</span><span class="dv">2</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dist</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> compute_accumulated_cost_matrix(x, y) <span class="op">-&gt;</span> np.array:</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Compute accumulated cost matrix for warp path using Euclidean distance</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    distances <span class="op">=</span> compute_euclidean_distance_matrix(x, y)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialization</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    cost <span class="op">=</span> np.zeros((<span class="bu">len</span>(y), <span class="bu">len</span>(x)))</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    cost[<span class="dv">0</span>,<span class="dv">0</span>] <span class="op">=</span> distances[<span class="dv">0</span>,<span class="dv">0</span>]</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(y)):</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>        cost[i, <span class="dv">0</span>] <span class="op">=</span> distances[i, <span class="dv">0</span>] <span class="op">+</span> cost[i<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>]  </span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(x)):</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>        cost[<span class="dv">0</span>, j] <span class="op">=</span> distances[<span class="dv">0</span>, j] <span class="op">+</span> cost[<span class="dv">0</span>, j<span class="op">-</span><span class="dv">1</span>]  </span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Accumulated warp path cost</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(y)):</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(x)):</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>            cost[i, j] <span class="op">=</span> <span class="bu">min</span>(</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>                cost[i<span class="op">-</span><span class="dv">1</span>, j],    <span class="co"># insertion</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>                cost[i, j<span class="op">-</span><span class="dv">1</span>],    <span class="co"># deletion</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>                cost[i<span class="op">-</span><span class="dv">1</span>, j<span class="op">-</span><span class="dv">1</span>]   <span class="co"># match</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>            ) <span class="op">+</span> distances[i, j] </span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cost</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="example-1" class="level1">
<h1>Example 1</h1>
<p>In this example, we have two sequences <span class="math inline">x</span> and <span class="math inline">y</span>&nbsp;with different lengths.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create two sequences</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> [<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>]</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> [<span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>We cannot calculate the distance between <span class="math inline">x</span> and <span class="math inline">y</span> since they don‚Äôt have equal lengths (the code follows).</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/euclidean_distance.png" class="img-fluid figure-img" alt="Calculating Euclidean distance for two signals with different lengths. Is it possible?"></p>
<p></p><figcaption class="figure-caption">Example 1: Euclidean distance between x and y (is it possible? ü§î )</figcaption><p></p>
</figure>
</div>
<div class="sourceCode" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">10</span>))</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove the border and axes ticks</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>fig.patch.set_visible(<span class="va">False</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>ax.axis(<span class="st">'off'</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>xx <span class="op">=</span> [(i, x[i]) <span class="cf">for</span> i <span class="kw">in</span> np.arange(<span class="dv">0</span>, <span class="bu">len</span>(x))]</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>yy <span class="op">=</span> [(j, y[j]) <span class="cf">for</span> j <span class="kw">in</span> np.arange(<span class="dv">0</span>, <span class="bu">len</span>(y))]</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, j <span class="kw">in</span> <span class="bu">zip</span>(xx, yy[:<span class="op">-</span><span class="dv">2</span>]):</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    ax.plot([i[<span class="dv">0</span>], j[<span class="dv">0</span>]], [i[<span class="dv">1</span>], j[<span class="dv">1</span>]], <span class="st">'--k'</span>, linewidth<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>ax.plot(x, <span class="st">'-ro'</span>, label<span class="op">=</span><span class="st">'x'</span>, linewidth<span class="op">=</span><span class="dv">4</span>, markersize<span class="op">=</span><span class="dv">20</span>, markerfacecolor<span class="op">=</span><span class="st">'lightcoral'</span>, markeredgecolor<span class="op">=</span><span class="st">'lightcoral'</span>)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>ax.plot(y, <span class="st">'-bo'</span>, label<span class="op">=</span><span class="st">'y'</span>, linewidth<span class="op">=</span><span class="dv">4</span>, markersize<span class="op">=</span><span class="dv">20</span>, markerfacecolor<span class="op">=</span><span class="st">'skyblue'</span>, markeredgecolor<span class="op">=</span><span class="st">'skyblue'</span>)</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">"Euclidean Distance!??"</span>, fontsize<span class="op">=</span><span class="dv">28</span>, fontweight<span class="op">=</span><span class="st">"bold"</span>)</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>fig.savefig(<span class="st">"ex1_euclidean_distance.png"</span>, <span class="op">**</span>savefig_options)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="compute-dtw-distance-and-warp-path" class="level3">
<h3 class="anchored" data-anchor-id="compute-dtw-distance-and-warp-path">Compute DTW distance and warp&nbsp;path</h3>
<p>Many Python packages calculate the DTW by just providing the sequences and the type of distance (usually Euclidean by default). Here, we use a popular Python implementation of DTW that is&nbsp;<a href="https://github.com/slaypni/fastdtw">FastDTW</a>&nbsp;which is an approximate DTW algorithm with lower time and memory complexities <span class="citation" data-cites="salvador2007fastdtw">(see <a href="#ref-salvador2007fastdtw" role="doc-biblioref">Salvador and Chan 2007</a>)</span>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>dtw_distance, warp_path <span class="op">=</span> fastdtw(x, y, dist<span class="op">=</span>euclidean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Note that we are using <a href="https://pypi.org/project/scipy/">SciPy</a>‚Äôs distance function Euclidean that we imported earlier. For a better understanding of the warp path, let‚Äôs first compute the accumulated cost matrix and then visualize the path on a grid. The following code will plot a heatmap of the accumulated cost matrix.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>cost_matrix <span class="op">=</span> compute_accumulated_cost_matrix(x, y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">8</span>))</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sbn.heatmap(cost_matrix, annot<span class="op">=</span><span class="va">True</span>, square<span class="op">=</span><span class="va">True</span>, linewidths<span class="op">=</span><span class="fl">0.1</span>, cmap<span class="op">=</span><span class="st">"YlGnBu"</span>, ax<span class="op">=</span>ax)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>ax.invert_yaxis()</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the warp path in x and y directions</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>path_x <span class="op">=</span> [p[<span class="dv">0</span>] <span class="cf">for</span> p <span class="kw">in</span> warp_path]</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>path_y <span class="op">=</span> [p[<span class="dv">1</span>] <span class="cf">for</span> p <span class="kw">in</span> warp_path]</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Align the path from the center of each cell</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>path_xx <span class="op">=</span> [x<span class="op">+</span><span class="fl">0.5</span> <span class="cf">for</span> x <span class="kw">in</span> path_x]</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>path_yy <span class="op">=</span> [y<span class="op">+</span><span class="fl">0.5</span> <span class="cf">for</span> y <span class="kw">in</span> path_y]</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>ax.plot(path_xx, path_yy, color<span class="op">=</span><span class="st">'blue'</span>, linewidth<span class="op">=</span><span class="dv">3</span>, alpha<span class="op">=</span><span class="fl">0.2</span>)</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>fig.savefig(<span class="st">"ex1_heatmap.png"</span>, <span class="op">**</span>savefig_options)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/accumuldated_cost_matrix_warping_path.png" class="img-fluid figure-img" alt="Accumulated cost matrix and warping path"></p>
<p></p><figcaption class="figure-caption">Example 1: Accumulated cost matrix and warping path</figcaption><p></p>
</figure>
</div>
<p>The color bar shows the cost of each point in the grid. As can be seen, the warp path (blue line) is going through the lowest cost on the grid. Let‚Äôs see the DTW distance and the warping path by printing these two variables.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"DTW distance: "</span>, dtw_distance)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Warp path: "</span>, warp_path)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> DTW distance:  <span class="fl">6.0</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> Warp path:  [(<span class="dv">0</span>, <span class="dv">0</span>), (<span class="dv">1</span>, <span class="dv">1</span>), (<span class="dv">1</span>, <span class="dv">2</span>), (<span class="dv">2</span>, <span class="dv">3</span>), (<span class="dv">3</span>, <span class="dv">4</span>), (<span class="dv">4</span>, <span class="dv">5</span>), (<span class="dv">4</span>, <span class="dv">6</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The warping path starts at point (0, 0) and ends at (4, 6) by 6 moves. Let‚Äôs also calculate the accumulated cost most using the functions we defined earlier and compare the values with the heatmap.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>cost_matrix <span class="op">=</span> compute_accumulated_cost_matrix(x, y)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(np.flipud(cost_matrix)) <span class="co"># Flipping the cost matrix for easier comparison with heatmap values!</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> [[<span class="fl">32.</span> <span class="fl">12.</span> <span class="fl">10.</span> <span class="fl">10.</span>  <span class="fl">6.</span>]  </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>     [<span class="fl">23.</span> <span class="fl">11.</span>  <span class="fl">6.</span>  <span class="fl">6.</span>  <span class="fl">5.</span>]   </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>     [<span class="fl">19.</span> <span class="fl">11.</span>  <span class="fl">5.</span>  <span class="fl">5.</span>  <span class="fl">9.</span>]  </span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>     [<span class="fl">19.</span>  <span class="fl">7.</span>  <span class="fl">4.</span>  <span class="fl">5.</span>  <span class="fl">8.</span>]  </span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>     [<span class="fl">19.</span>  <span class="fl">3.</span>  <span class="fl">6.</span> <span class="fl">10.</span>  <span class="fl">4.</span>]  </span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>     [<span class="fl">10.</span>  <span class="fl">2.</span>  <span class="fl">6.</span>  <span class="fl">6.</span>  <span class="fl">3.</span>]  </span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>     [ <span class="fl">1.</span>  <span class="fl">2.</span>  <span class="fl">2.</span>  <span class="fl">2.</span>  <span class="fl">3.</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The cost matrix is printed above has similar values to the heatmap.</p>
<p>Now let‚Äôs plot the two sequences and connect the mapping points. The code to plot the DTW distance between&nbsp;<span class="math inline">x</span>&nbsp;and&nbsp;<span class="math inline">y</span>&nbsp;is given below.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">10</span>))</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove the border and axes ticks</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>fig.patch.set_visible(<span class="va">False</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>ax.axis(<span class="st">'off'</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> [map_x, map_y] <span class="kw">in</span> warp_path:</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    ax.plot([map_x, map_y], [x[map_x], y[map_y]], <span class="st">'--k'</span>, linewidth<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>ax.plot(x, <span class="st">'-ro'</span>, label<span class="op">=</span><span class="st">'x'</span>, linewidth<span class="op">=</span><span class="dv">4</span>, markersize<span class="op">=</span><span class="dv">20</span>, markerfacecolor<span class="op">=</span><span class="st">'lightcoral'</span>, markeredgecolor<span class="op">=</span><span class="st">'lightcoral'</span>)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>ax.plot(y, <span class="st">'-bo'</span>, label<span class="op">=</span><span class="st">'y'</span>, linewidth<span class="op">=</span><span class="dv">4</span>, markersize<span class="op">=</span><span class="dv">20</span>, markerfacecolor<span class="op">=</span><span class="st">'skyblue'</span>, markeredgecolor<span class="op">=</span><span class="st">'skyblue'</span>)</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">"DTW Distance"</span>, fontsize<span class="op">=</span><span class="dv">28</span>, fontweight<span class="op">=</span><span class="st">"bold"</span>)</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>fig.savefig(<span class="st">"ex1_dtw_distance.png"</span>, <span class="op">**</span>savefig_options)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/dtw_between_x_and_y.png" class="img-fluid figure-img" alt="DTW distance between x and y"></p>
<p></p><figcaption class="figure-caption">Example 1: DTW distance between x and y</figcaption><p></p>
</figure>
</div>
</section>
</section>
<section id="example-2" class="level1">
<h1>Example 2</h1>
<p>In this example, we will use two sinusoidal signals and see how they will be matched by calculating the DTW distance between them.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>time1 <span class="op">=</span> np.linspace(start<span class="op">=</span><span class="dv">0</span>, stop<span class="op">=</span><span class="dv">1</span>, num<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>time2 <span class="op">=</span> time1[<span class="dv">0</span>:<span class="dv">40</span>]</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>x1 <span class="op">=</span> <span class="dv">3</span> <span class="op">*</span> np.sin(np.pi <span class="op">*</span> time1) <span class="op">+</span> <span class="fl">1.5</span> <span class="op">*</span> np.sin(<span class="dv">4</span><span class="op">*</span>np.pi <span class="op">*</span> time1)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>x2 <span class="op">=</span> <span class="dv">3</span> <span class="op">*</span> np.sin(np.pi <span class="op">*</span> time2 <span class="op">+</span> <span class="fl">0.5</span>) <span class="op">+</span> <span class="fl">1.5</span> <span class="op">*</span> np.sin(<span class="dv">4</span><span class="op">*</span>np.pi <span class="op">*</span> time2 <span class="op">+</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Just like Example 1, let‚Äôs calculate the DTW distance and the warp path for x1 and x2 signals using FastDTW package.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>distance, warp_path <span class="op">=</span> fastdtw(x1, x2, dist<span class="op">=</span>euclidean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">16</span>, <span class="dv">12</span>))</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove the border and axes ticks</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>fig.patch.set_visible(<span class="va">False</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>ax.axis(<span class="st">'off'</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> [map_x, map_y] <span class="kw">in</span> warp_path:</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    ax.plot([map_x, map_y], [x1[map_x], x2[map_y]], <span class="st">'-k'</span>)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>ax.plot(x1, color<span class="op">=</span><span class="st">'blue'</span>, marker<span class="op">=</span><span class="st">'o'</span>, markersize<span class="op">=</span><span class="dv">10</span>, linewidth<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>ax.plot(x2, color<span class="op">=</span><span class="st">'red'</span>, marker<span class="op">=</span><span class="st">'o'</span>, markersize<span class="op">=</span><span class="dv">10</span>, linewidth<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>ax.tick_params(axis<span class="op">=</span><span class="st">"both"</span>, which<span class="op">=</span><span class="st">"major"</span>, labelsize<span class="op">=</span><span class="dv">18</span>)</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>fig.savefig(<span class="st">"ex2_dtw_distance.png"</span>, <span class="op">**</span>savefig_options)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/dtw_sinusoidals.png" class="img-fluid figure-img" alt="DTW distance between two sinosoidal signal, x1 and x2"></p>
<p></p><figcaption class="figure-caption">Example 2: DTW distance between x1 and x2</figcaption><p></p>
</figure>
</div>
<p>As can be seen in above figure, the DTW distance between the two signals is particularly powerful when the signals have similar patterns. The extrema (maximum and minimum points) between the two signals are correctly mapped. Moreover, unlike Euclidean distance, we may see many-to-one mapping when DTW distance is used, particularly if the two signals have different lengths.</p>
<p>You may spot an issue with dynamic time warping from the figure above. Can you guess what it is?</p>
<p>The issue is around the head and tail of time-series that do not properly match. This is because the DTW algorithm cannot afford the warping invariance for at the endpoints. In short, the effect of this is that a small difference at the sequence endpoints will tend to contribute disproportionately to the estimated similarity <span class="citation" data-cites="silva2016dtw_endpoints">(see <a href="#ref-silva2016dtw_endpoints" role="doc-biblioref">Silva et al. 2016</a>)</span>.</p>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p>DTW is an algorithm to find an optimal alignment between two sequences and a useful distance metric to have in our toolbox. This technique is useful when we are working with two non-linear sequences, particularly if one sequence is a non-linear stretched/shrunk version of the other. The warping path is a combination of ‚Äúchess king‚Äù moves that starts from the head of two sequences and ends with their tails.</p>
<div class="callout callout callout-style-simple no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>üìì You can find the Jupyter notebook for this blog post on <a href="https://github.com/e-alizadeh/medium/blob/master/notebooks/intro_to_dtw.ipynb">GitHub</a>.</p>
</div>
</div>
</div>
</section>
<section id="useful-links" class="level1">
<h1>Useful Links</h1>
<p><a href="https://nipunbatra.github.io/blog/ml/2014/05/01/dtw.html">Programatically understanding dynamic time warping (DTW)</a></p>
<p><a href="https://databricks.com/blog/2019/04/30/understanding-dynamic-time-warping.html">Understanding Dynamic Time Warping - The Databricks Blog</a></p>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-berndt1994dtw" class="csl-entry" role="doc-biblioentry">
Berndt, Donald J, and James Clifford. 1994. <span>‚ÄúUsing Dynamic Time Warping to Find Patterns in Time Series.‚Äù</span> In <em>KDD Workshop</em>, 10:359‚Äì70. 16. Seattle, WA, USA. <a href="https://www.aaai.org/Papers/Workshops/1994/WS-94-03/WS94-03-031.pdf">https://www.aaai.org/Papers/Workshops/1994/WS-94-03/WS94-03-031.pdf</a>.
</div>
<div id="ref-salvador2007fastdtw" class="csl-entry" role="doc-biblioentry">
Salvador, Stan, and Philip Chan. 2007. <span>‚ÄúToward Accurate Dynamic Time Warping in Linear Time and Space.‚Äù</span> <em>Intelligent Data Analysis</em> 11 (5): 561‚Äì80. <a href="https://cs.fit.edu/~pkc/papers/tdm04.pdf">https://cs.fit.edu/~pkc/papers/tdm04.pdf</a>.
</div>
<div id="ref-silva2016dtw_endpoints" class="csl-entry" role="doc-biblioentry">
Silva, Diego Furtado, GEAPA Batista, Eamonn Keogh, et al. 2016. <span>‚ÄúOn the Effect of Endpoints on Dynamic Time Warping.‚Äù</span> <em>SIGKDD MiLeTS</em> 16: 10. <a href="https://core.ac.uk/display/147806669">https://core.ac.uk/display/147806669</a>.
</div>
</div></section><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{alizadeh2020,
  author = {Esmaeil Alizadeh},
  title = {An {Illustrative} {Introduction} to {Dynamic} {Time}
    {Warping}},
  date = {2020-10-11},
  url = {https://new.ealizadeh.com/blog/introduction-to-dynamic-time-warping},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-alizadeh2020" class="csl-entry quarto-appendix-citeas" role="doc-biblioentry">
Esmaeil Alizadeh. 2020. <span>‚ÄúAn Illustrative Introduction to Dynamic
Time Warping.‚Äù</span> October 11, 2020. <a href="https://new.ealizadeh.com/blog/introduction-to-dynamic-time-warping">https://new.ealizadeh.com/blog/introduction-to-dynamic-time-warping</a>.
</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="e-alizadeh/website" data-repo-id="R_kgDOH_Z9yg" data-category="Blog" data-category-id="" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" data-loading="lazy" async="">
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
      <div class="nav-footer-center">¬©Ô∏è 2022 Esmaeil Alizadeh - All Rights Reserved</div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/e-alizadeh">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/es_alizadeh">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>



<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>