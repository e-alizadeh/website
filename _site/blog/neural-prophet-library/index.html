<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.203">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Esmaeil Alizadeh">
<meta name="dcterms.date" content="2020-12-03">

<title>Essi Alizadeh - NeuralProphet: A Time-Series Modeling Python Library based on Neural-Networks</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../assets/favicon.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

<script type="text/javascript">

(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-180647948-1', 'auto');

ga('send', {
  hitType: 'pageview',
  'anonymizeIp': true,
});
</script>
<style>html{ scroll-behavior: smooth; }</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">


<link rel="stylesheet" href="../../styles.css">
<meta property="og:title" content="Essi Alizadeh - NeuralProphet: A Time-Series Modeling Python Library based on Neural-Networks">
<meta property="og:description" content="">
<meta property="og:image" content="https://new.ealizadeh.com/blog/neural-prophet-library/img/_featured_image.png">
<meta property="og:site-name" content="Essi Alizadeh">
<meta property="og:image:height" content="804">
<meta property="og:image:width" content="1080">
<meta name="twitter:title" content="Essi Alizadeh - NeuralProphet: A Time-Series Modeling Python Library based on Neural-Networks">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="https://new.ealizadeh.com/blog/neural-prophet-library/img/_featured_image.png">
<meta name="twitter:creator" content="@es_alizadeh">
<meta name="twitter:site" content="@es_alizadeh">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image-height" content="804">
<meta name="twitter:image-width" content="1080">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Essi Alizadeh</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blog.html">
 <span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../contact_me.html">
 <span class="menu-text">Contact me</span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">NeuralProphet: A Time-Series Modeling Python Library based on Neural-Networks</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">Machine Learning</div>
                <div class="quarto-category">Neural-Network</div>
                <div class="quarto-category">Python Library</div>
                <div class="quarto-category">Time Series Analysis</div>
                <div class="quarto-category">Tutorial</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Esmaeil Alizadeh </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">December 3, 2020</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#neuralprophet-library" id="toc-neuralprophet-library" class="nav-link active" data-scroll-target="#neuralprophet-library">NeuralProphet Library</a>
  <ul>
  <li><a href="#neuralprophet-vs.-prophet" id="toc-neuralprophet-vs.-prophet" class="nav-link" data-scroll-target="#neuralprophet-vs.-prophet">NeuralProphet vs.&nbsp;Prophet</a></li>
  <li><a href="#project-maintainers" id="toc-project-maintainers" class="nav-link" data-scroll-target="#project-maintainers">Project Maintainers</a></li>
  <li><a href="#installation" id="toc-installation" class="nav-link" data-scroll-target="#installation">Installation</a></li>
  <li><a href="#implementation-with-a-case-study" id="toc-implementation-with-a-case-study" class="nav-link" data-scroll-target="#implementation-with-a-case-study"><strong>Implementation with a Case Study</strong></a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  <li><a href="#useful-links" id="toc-useful-links" class="nav-link" data-scroll-target="#useful-links">Useful Links</a></li>
  </ul>
</nav>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar"><div class="quarto-margin-header"><div class="margin-header-item">
<!-- Main CSS style -->
<style type="text/css" media="screen">
    #mailchimp {
   /* background: #F7F9FB; */
   color: #595c5f;
   /* padding: 20px 15px; */
}
   #mailchimp input {
   border-width: 2px;
   border-style: solid;
   border-color: gray;
   color: gray;
   font-family: Arial, Helvetica, sans-serif;
   font-size: 14px;
   /*font-style: italic;*/
   margin-bottom: 10px;
   padding: 8px 10px;
   /* width: 275px; */
    border-radius: 15px;
    -moz-border-radius: 15px;
    -webkit-border-radius: 15px;
   }
   #mailchimp input.email { background: #fff; padding: 10px; text-align: left;}
   #mailchimp input.name { background: #fff; padding: 10px; text-align: left;}
   #mailchimp input[type="submit"] {
       background: #8FC1E3;
       border: none;
       color: #fff;
       cursor: pointer;
       font-size: 15px;
       margin-top: -2px;
       /* width: 55%; */
       /* padding: 8px 0; */
   }
   #mailchimp input[type="submit"]:hover { background: #99DDFF; color: #fff }
   
   .mailinglist{
       color: #595c5f;
       text-align: left;
       font-size: 18px;
       font-weight: bold;
       font-family: Arial, Helvetica, sans-serif;
       /* padding-left: 2.0em; */
       padding-bottom: 3px;
   }

   .footnote {
       color: grey;
       font-family: Arial, Helvetica, sans-serif;
       font-size: 12px;
       margin-top: -3px;
       padding-left: 1.5em;
       }
   /* Errors */
   .error {
   border-color: red;
   }

   .error-message {
        color: red;
        font-style: italic;
        font-size: 12px;
        margin-top: -4px;
        margin-bottom: 3px;
        padding-left: 1.5em;
    }
</style>


<!-- Begin Integrating Email Constraint Validation using a JavaScript API -->
<script>
   // Add the novalidate attribute when the JS loads
   var forms = document.querySelectorAll('.validate');
   for (var i = 0; i < forms.length; i++) {
       forms[i].setAttribute('novalidate', true);
   }


   // Validate the field
   var hasError = function (field) {

       // Don't validate submits, buttons, file and reset inputs, and disabled fields
       if (field.disabled || field.type === 'file' || field.type === 'reset' || field.type === 'submit' || field.type === 'button') return;

       // Get validity
       var validity = field.validity;

       // If valid, return null
       if (validity.valid) return;

       // If field is required and empty
       if (validity.valueMissing) return 'Please fill out this field.';

       // If not the right type
       if (validity.typeMismatch) {

           // Email
           if (field.type === 'email') return 'Please enter an email address.';

           // URL
           if (field.type === 'url') return 'Please enter a URL.';

       }

       // If too short
       if (validity.tooShort) return 'Please lengthen this text to ' + field.getAttribute('minLength') + ' characters or more. You are currently using ' + field.value.length + ' characters.';

       // If too long
       if (validity.tooLong) return 'Please shorten this text to no more than ' + field.getAttribute('maxLength') + ' characters. You are currently using ' + field.value.length + ' characters.';

       // If pattern doesn't match
       if (validity.patternMismatch) {

           // If pattern info is included, return custom error
           if (field.hasAttribute('title')) return field.getAttribute('title');

           // Otherwise, generic error
           return 'Please match the requested format.';

       }

       // If number input isn't a number
       if (validity.badInput) return 'Please enter a number.';

       // If a number value doesn't match the step interval
       if (validity.stepMismatch) return 'Please select a valid value.';

       // If a number field is over the max
       if (validity.rangeOverflow) return 'Please select a value that is no more than ' + field.getAttribute('max') + '.';

       // If a number field is below the min
       if (validity.rangeUnderflow) return 'Please select a value that is no less than ' + field.getAttribute('min') + '.';

       // If all else fails, return a generic catchall error
       return 'The value you entered for this field is invalid.';

   };


   // Show an error message
   var showError = function (field, error) {

       // Add error class to field
       field.classList.add('error');
   
       // If the field is a radio button and part of a group, error all and get the last item in the group
       if (field.type === 'radio' && field.name) {
           var group = field.form.querySelectorAll('[name="' + field.name + '"]');
           if (group.length > 0) {
               for (var i = 0; i < group.length; i++) {
                   group[i].classList.add('error');
               }
               field = group[group.length - 1];
           }
       }

       // Get field id or name
       var id = field.id || field.name;
       if (!id) return;

       // Check if error message field already exists
       // If not, create one
       var message = field.form.querySelector('.error-message#error-for-' + id );
       if (!message) {
           message = document.createElement('div');
           message.className = 'error-message';
           message.id = 'error-for-' + id;
           
           // If the field is a radio button or checkbox, insert error after the label
           var label;
           if (field.type === 'radio' || field.type ==='checkbox') {
               label = field.form.querySelector('label[for="' + id + '"]') || field.parentNode;
               if (label) {
                   label.parentNode.insertBefore( message, label.nextSibling );
               }
           }

           // Otherwise, insert it after the field
           if (!label) {
               field.parentNode.insertBefore( message, field.nextSibling );
           }

       }
       
       // Add ARIA role to the field
       field.setAttribute('aria-describedby', 'error-for-' + id);

       // Update error message
       message.innerHTML = error;

       // Show error message
       message.style.display = 'block';
       message.style.visibility = 'visible';

   };


   // Remove the error message
   var removeError = function (field) {

       // Remove error class to field
       field.classList.remove('error');
       
       // Remove ARIA role from the field
       field.removeAttribute('aria-describedby');

       // If the field is a radio button and part of a group, remove error from all and get the last item in the group
       if (field.type === 'radio' && field.name) {
           var group = field.form.querySelectorAll('[name="' + field.name + '"]');
           if (group.length > 0) {
               for (var i = 0; i < group.length; i++) {
                   group[i].classList.remove('error');
               }
               field = group[group.length - 1];
           }
       }

       // Get field id or name
       var id = field.id || field.name;
       if (!id) return;
       

       // Check if an error message is in the DOM
       var message = field.form.querySelector('.error-message#error-for-' + id + '');
       if (!message) return;

       // If so, hide it
       message.innerHTML = '';
       message.style.display = 'none';
       message.style.visibility = 'hidden';

   };


   // Listen to all blur events
   document.addEventListener('blur', function (event) {

       // Only run if the field is in a form to be validated
       if (!event.target.form.classList.contains('validate')) return;

       // Validate the field
       var error = hasError(event.target);
   
       // If there's an error, show it
       if (error) {
           showError(event.target, error);
           return;
       }

       // Otherwise, remove any existing error message
       removeError(event.target);

   }, true);


   // Check all fields on submit
   document.addEventListener('submit', function (event) {

       // Only run on forms flagged for validation
       if (!event.target.classList.contains('validate')) return;

       // Get all of the form elements
       var fields = event.target.elements;

       // Validate each field
       // Store the first field with an error to a variable so we can bring it into focus later
       var error, hasErrors;
       for (var i = 0; i < fields.length; i++) {
           error = hasError(fields[i]);
           if (error) {
               showError(fields[i], error);
               if (!hasErrors) {
                   hasErrors = fields[i];
               }
           }
       }

       // If there are errrors, don't submit form and focus on first element with error
       if (hasErrors) {
           event.preventDefault();
           hasErrors.focus();
       }

       // Otherwise, let the form submit normally
       // You could also bolt in an Ajax form submit process here

   }, false);
</script>
<!-- End of JavaScript Email Constraint Validation -->


<!-- Begin MailChimp Signup Form -->
<div id="mailchimp">
   <form action="https://ealizadeh.us10.list-manage.com/subscribe/post?u=912b9dacf23679bd0a6e46b22&amp;id=31485d9fc5" method="post" id="mc-embedded-subscribe-form" class="validate" style="max-width:450px;margin:auto" name="mc-embedded-subscribe-form" target="_blank" novalidate="">
       <!-- <i class="fa fa-envelope icon"> </i> -->    
       <h3 aria-hidden="true" class="fas fa-paper-plane mailinglist">Mailing List</h3>
           <!-- <div class="input-icons">  -->
                       <!-- <div class="input-icons">  -->
           <div class="clear">
               <i class="fa fa-envelope"> </i>
               <input class="required email" type="email" size="17" placeholder="E-mail Address" name="EMAIL" id="mce-EMAIL" title="The domain portion of the email address is invalid (the portion after the @)." pattern="^([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x22([^\x0d\x22\x5c\x80-\xff]|\x5c[\x00-\x7f])*\x22)(\x2e([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x22([^\x0d\x22\x5c\x80-\xff]|\x5c[\x00-\x7f])*\x22))*\x40([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x5b([^\x0d\x5b-\x5d\x80-\xff]|\x5c[\x00-\x7f])*\x5d)(\x2e([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x5b([^\x0d\x5b-\x5d\x80-\xff]|\x5c[\x00-\x7f])*\x5d))*(\.\w{2,})+$" required="">
           </div>
           <div class="clear">
               <i class="fa fa-user"> </i> 
               <input class="name" type="text" size="17" placeholder="Name (Optional)" name="FNAME" id="mce-FNAME">
           </div>

           <!-- <div class="footnote"> -->
               <p class="footnote"> No Spam. Unsubscribe anytime.</p>
           <!-- </div> -->
       <div id="mce-responses" class="clear">
           <div class="response" id="mce-error-response" style="display:none"></div>
           <div class="response" id="mce-success-response" style="display:none"></div>
       </div>
       
       <!-- <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_f2d244c0df42a0431bd08ddea_aeaa9dd034" tabindex="-1" value=""></div> -->
       <div class="clear">
           <input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button">
       </div>
   </form>
</div>
<!--End of MailChimp Signup Form-->
</div></div>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<p><img src="img/_featured_image.png" class="img-fluid" alt="Featured image of the post"></p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>👉 This article is also published on&nbsp;<a href="https://towardsdatascience.com/neural-prophet-a-time-series-modeling-library-based-on-neural-networks-dd02dc8d868d"><strong>Towards Data Science blog</strong></a>.</p>
</div>
</div>
<p><a href="https://github.com/ourownstory/neural_prophet">NeuralProphet</a> <a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>&nbsp;is a python library for modeling time-series data based on neural networks. It’s built on top of&nbsp;<a href="https://pytorch.org/">PyTorch</a>&nbsp;and is heavily inspired by&nbsp;<a href="https://github.com/facebook/prophet">Facebook Prophet</a>&nbsp;and&nbsp;<a href="https://github.com/ourownstory/AR-Net">AR-Net</a>&nbsp;libraries.</p>
<section id="neuralprophet-library" class="level1">
<h1>NeuralProphet Library</h1>
<section id="neuralprophet-vs.-prophet" class="level2">
<h2 class="anchored" data-anchor-id="neuralprophet-vs.-prophet">NeuralProphet vs.&nbsp;Prophet</h2>
<p>From the library name, you may ask what is the main difference between Facebook’s Prophet library and NeuralProphet. According to NeuralProphet’s&nbsp;<a href="https://ourownstory.github.io/neural_prophet/changes-from-prophet/">documentation</a>, the added features are:</p>
<ul>
<li>Using PyTorch’s Gradient Descent optimization engine making the modeling process much faster than Prophet</li>
<li>Using AR-Net for modeling time-series autocorrelation (aka serial correlation)</li>
<li>Custom losses and metrics</li>
<li>Having configurable non-linear layers of feed-forward neural networks,</li>
<li><em>etc</em>.</li>
</ul>
</section>
<section id="project-maintainers" class="level2">
<h2 class="anchored" data-anchor-id="project-maintainers">Project Maintainers</h2>
<p>Based on the project’s GitHub page, the main maintainer of this project is&nbsp;<a href="https://github.com/ourownstory">Oskar Triebe</a>&nbsp;from Stanford University with collaboration from Facebook and Monash University.</p>
</section>
<section id="installation" class="level2">
<h2 class="anchored" data-anchor-id="installation">Installation</h2>
<p>The project is in the beta phase, so I would advise you to be cautious if you want to use this library in a production environment.</p>
<p>You can install the package using&nbsp;<code>pip install neuralprophet</code>. However, if you are going to use the package in a Jupyter Notebook environment, you should install their live version&nbsp;<code>pip install neuralprophet[live]</code>. This will provide more features such as a live plot of train and validation loss using&nbsp;<code>plot_live_loss()</code>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> clone https://github.com/ourownstory/neural_prophet</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> neural_prophet</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install .[live]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>I would recommend creating a fresh environment (a conda or venv) and installing the NeuralProphet package from the new environment letting the installer take care of all dependencies (it has Pandas, Jupyter Notebook, PyTorch as dependencies).</p>
<p>Now that we have the package installed, let’s play!</p>
</section>
<section id="implementation-with-a-case-study" class="level2">
<h2 class="anchored" data-anchor-id="implementation-with-a-case-study"><strong>Implementation with a Case Study</strong></h2>
<p>Here, I’m using the daily climate data in Delhi from 2013 to 2017 that I found on&nbsp;<a href="https://www.kaggle.com/sumanthvrao/daily-climate-time-series-data">Kaggle</a>. First, let’s import the main packages.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> neuralprophet <span class="im">import</span> NeuralProphet</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Then, we can read the data into a Panda DataFrame. NeuralProphet object expects the time-series data to have a date column named <code>ds</code> and the time-series column value we want to predict as <code>y</code>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data is from https://www.kaggle.com/sumanthvrao/daily-climate-time-series-data</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">"./DailyDelhiClimateTrain.csv"</span>, parse_dates<span class="op">=</span>[<span class="st">"date"</span>])</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df[[<span class="st">"date"</span>, <span class="st">"meantemp"</span>]]</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>df.rename(columns<span class="op">=</span>{<span class="st">"date"</span>: <span class="st">"ds"</span>, <span class="st">"meantemp"</span>: <span class="st">"y"</span>}, inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Now let’s initialize the model. Below, I’ve brought all default arguments defined for the NeuralProphet object, including additional information about some. These are the hyperparameters you can configure in the model. Of course, if you are planning to use the default variables, you can just do <code>model = NeuralProphet()</code>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># model = NeuralProphet() if you're using default variables below.</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> NeuralProphet(</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    growth<span class="op">=</span><span class="st">"linear"</span>,  <span class="co"># Determine trend types: 'linear', 'discontinuous', 'off'</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    changepoints<span class="op">=</span><span class="va">None</span>, <span class="co"># list of dates that may include change points (None -&gt; automatic )</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    n_changepoints<span class="op">=</span><span class="dv">5</span>,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    changepoints_range<span class="op">=</span><span class="fl">0.8</span>,</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    trend_reg<span class="op">=</span><span class="dv">0</span>,</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    trend_reg_threshold<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    yearly_seasonality<span class="op">=</span><span class="st">"auto"</span>,</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    weekly_seasonality<span class="op">=</span><span class="st">"auto"</span>,</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    daily_seasonality<span class="op">=</span><span class="st">"auto"</span>,</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    seasonality_mode<span class="op">=</span><span class="st">"additive"</span>,</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    seasonality_reg<span class="op">=</span><span class="dv">0</span>,</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>    n_forecasts<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    n_lags<span class="op">=</span><span class="dv">0</span>,</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>    num_hidden_layers<span class="op">=</span><span class="dv">0</span>,</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    d_hidden<span class="op">=</span><span class="va">None</span>,     <span class="co"># Dimension of hidden layers of AR-Net</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>    ar_sparsity<span class="op">=</span><span class="va">None</span>,  <span class="co"># Sparcity in the AR coefficients</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>    learning_rate<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>    epochs<span class="op">=</span><span class="dv">40</span>,</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>    loss_func<span class="op">=</span><span class="st">"Huber"</span>,</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>    normalize<span class="op">=</span><span class="st">"auto"</span>,  <span class="co"># Type of normalization ('minmax', 'standardize', 'soft', 'off')</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>    impute_missing<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>    log_level<span class="op">=</span><span class="va">None</span>, <span class="co"># Determines the logging level of the logger object</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>After configuring the model and its hyperparameters, we need to train the model and make predictions. Let’s make up to a one-year prediction of the temperature.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>metrics <span class="op">=</span> model.fit(df, validate_each_epoch<span class="op">=</span><span class="va">True</span>, freq<span class="op">=</span><span class="st">"D"</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>future <span class="op">=</span> model.make_future_dataframe(df, periods<span class="op">=</span><span class="dv">365</span>, n_historic_predictions<span class="op">=</span><span class="bu">len</span>(df))</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>forecast <span class="op">=</span> model.predict(future)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>You can simply plot the forecast by calling <code>model.plot(forecast)</code> as following:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">10</span>))</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>model.plot(forecast, xlabel<span class="op">=</span><span class="st">"Date"</span>, ylabel<span class="op">=</span><span class="st">"Temp"</span>, ax<span class="op">=</span>ax)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">"Mean Temperature in Delhi"</span>, fontsize<span class="op">=</span><span class="dv">28</span>, fontweight<span class="op">=</span><span class="st">"bold"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The one-year forecast plot is shown below, where the time period between 2017-01-01 to 2018-01-01 is the prediction. As can be seen, the forecast plot resembles the historical time-series. It both captured the seasonality as well as the slow-growing linear trend.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/mean_temp_1yr_prediction.png" class="img-fluid figure-img" alt="The mean temperature in Delhi and the one-year prediction."></p>
<p></p><figcaption class="figure-caption">The mean temperature in Delhi and the one-year prediction</figcaption><p></p>
</figure>
</div>
<p>You can plot the parameters by calling <code>model.plot_parameters()</code></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/model_parameters.png" class="img-fluid figure-img" alt="Neural-Prophet model parameters"></p>
<p></p><figcaption class="figure-caption">Model parameters</figcaption><p></p>
</figure>
</div>
<p>The model loss using Mean Absolute Error (MAE) is plotted below. You can also use the Smoothed L1-Loss function.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">10</span>))</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>ax.plot(metrics[<span class="st">"MAE"</span>], <span class="st">'ob'</span>, linewidth<span class="op">=</span><span class="dv">6</span>, label<span class="op">=</span><span class="st">"Training Loss"</span>)  </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>ax.plot(metrics[<span class="st">"MAE_val"</span>], <span class="st">'-r'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="st">"Validation Loss"</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># You can use metrics["SmoothL1Loss"] and metrics["SmoothL1Loss_val"] too.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/model_loss_mae.png" class="img-fluid figure-img" alt="Model Loss using MAE"></p>
<p></p><figcaption class="figure-caption">Model Loss using MAE</figcaption><p></p>
</figure>
</div>
</section>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p>In this post, we talked about NeuralProphet, a python library that models time-series based on Neural Networks. The library uses PyTorch as a backend. As a case study, we created a prediction model for daily Delhi climate time-series data and made a one-year prediction. An advantage of using this library is its similar syntax to Facebook’s Prophet library.</p>
<div class="callout callout callout-style-simple no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>📓 You can find the Jupyter notebook for this blog post on&nbsp;<a href="https://github.com/e-alizadeh/medium/blob/master/notebooks/NeuralProphet/neural_prophet.ipynb">GitHub</a>.</p>
</div>
</div>
</div>
</section>
<section id="useful-links" class="level1">
<h1>Useful Links</h1>
<p><a href="https://facebook.github.io/prophet/">Facebook’s Prophet Library</a></p>
<p><a href="https://github.com/ourownstory/AR-Net">AR-Net GitHub</a></p>


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p><a href="https://ourownstory.github.io/neural_prophet/">NeuralProphet Documentation</a><a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{alizadeh2020,
  author = {Esmaeil Alizadeh},
  title = {NeuralProphet: {A} {Time-Series} {Modeling} {Python}
    {Library} Based on {Neural-Networks}},
  date = {2020-12-03},
  url = {https://new.ealizadeh.com/blog/neural-prophet-library},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-alizadeh2020" class="csl-entry quarto-appendix-citeas" role="doc-biblioentry">
Esmaeil Alizadeh. 2020. <span>“NeuralProphet: A Time-Series Modeling
Python Library Based on Neural-Networks.”</span> December 3, 2020. <a href="https://new.ealizadeh.com/blog/neural-prophet-library">https://new.ealizadeh.com/blog/neural-prophet-library</a>.
</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="e-alizadeh/website" data-repo-id="R_kgDOH_Z9yg" data-category="Blog" data-category-id="" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" data-loading="lazy" async="">
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
      <div class="nav-footer-center">©️ 2022 Esmaeil Alizadeh - All Rights Reserved</div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/e-alizadeh">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/es_alizadeh">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>



<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>