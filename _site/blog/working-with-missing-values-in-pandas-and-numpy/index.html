<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.203">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Esmaeil Alizadeh">
<meta name="dcterms.date" content="2019-11-10">

<title>Essi Alizadeh - Working with Missing Values in Pandas and NumPy</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../assets/favicon.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

<script type="text/javascript">

(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-180647948-1', 'auto');

ga('send', {
  hitType: 'pageview',
  'anonymizeIp': true,
});
</script>
<style>html{ scroll-behavior: smooth; }</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">


<link rel="stylesheet" href="../../styles.css">
<meta property="og:title" content="Essi Alizadeh - Working with Missing Values in Pandas and NumPy">
<meta property="og:description" content="Pay attention to missing values in Python.">
<meta property="og:image" content="https://new.ealizadeh.com/blog/working-with-missing-values-in-pandas-and-numpy/img/_featured_image.png">
<meta property="og:site-name" content="Essi Alizadeh">
<meta property="og:image:height" content="468">
<meta property="og:image:width" content="1126">
<meta name="twitter:title" content="Essi Alizadeh - Working with Missing Values in Pandas and NumPy">
<meta name="twitter:description" content="Pay attention to missing values in Python.">
<meta name="twitter:image" content="https://new.ealizadeh.com/blog/working-with-missing-values-in-pandas-and-numpy/img/_featured_image.png">
<meta name="twitter:creator" content="@es_alizadeh">
<meta name="twitter:site" content="@es_alizadeh">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image-height" content="468">
<meta name="twitter:image-width" content="1126">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Essi Alizadeh</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blog.html">
 <span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../contact_me.html">
 <span class="menu-text">Contact me</span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Working with Missing Values in Pandas and NumPy</h1>
            <p class="subtitle lead">Pay attention to missing values in Python.</p>
                                <div class="quarto-categories">
                <div class="quarto-category">Python</div>
                <div class="quarto-category">Pandas</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Esmaeil Alizadeh </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">November 10, 2019</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar"><div class="quarto-margin-header"><div class="margin-header-item">
<!-- Main CSS style -->
<style type="text/css" media="screen">
    #mailchimp {
   /* background: #F7F9FB; */
   color: #595c5f;
   /* padding: 20px 15px; */
}
   #mailchimp input {
   border-width: 2px;
   border-style: solid;
   border-color: gray;
   color: gray;
   font-family: Arial, Helvetica, sans-serif;
   font-size: 14px;
   /*font-style: italic;*/
   margin-bottom: 10px;
   padding: 8px 10px;
   /* width: 275px; */
    border-radius: 15px;
    -moz-border-radius: 15px;
    -webkit-border-radius: 15px;
   }
   #mailchimp input.email { background: #fff; padding: 10px; text-align: left;}
   #mailchimp input.name { background: #fff; padding: 10px; text-align: left;}
   #mailchimp input[type="submit"] {
       background: #8FC1E3;
       border: none;
       color: #fff;
       cursor: pointer;
       font-size: 15px;
       margin-top: -2px;
       /* width: 55%; */
       /* padding: 8px 0; */
   }
   #mailchimp input[type="submit"]:hover { background: #99DDFF; color: #fff }
   
   .mailinglist{
       color: #595c5f;
       text-align: left;
       font-size: 18px;
       font-weight: bold;
       font-family: Arial, Helvetica, sans-serif;
       /* padding-left: 2.0em; */
       padding-bottom: 3px;
   }

   .footnote {
       color: grey;
       font-family: Arial, Helvetica, sans-serif;
       font-size: 12px;
       margin-top: -3px;
       padding-left: 1.5em;
       }
   /* Errors */
   .error {
   border-color: red;
   }

   .error-message {
        color: red;
        font-style: italic;
        font-size: 12px;
        margin-top: -4px;
        margin-bottom: 3px;
        padding-left: 1.5em;
    }
</style>


<!-- Begin Integrating Email Constraint Validation using a JavaScript API -->
<script>
   // Add the novalidate attribute when the JS loads
   var forms = document.querySelectorAll('.validate');
   for (var i = 0; i < forms.length; i++) {
       forms[i].setAttribute('novalidate', true);
   }


   // Validate the field
   var hasError = function (field) {

       // Don't validate submits, buttons, file and reset inputs, and disabled fields
       if (field.disabled || field.type === 'file' || field.type === 'reset' || field.type === 'submit' || field.type === 'button') return;

       // Get validity
       var validity = field.validity;

       // If valid, return null
       if (validity.valid) return;

       // If field is required and empty
       if (validity.valueMissing) return 'Please fill out this field.';

       // If not the right type
       if (validity.typeMismatch) {

           // Email
           if (field.type === 'email') return 'Please enter an email address.';

           // URL
           if (field.type === 'url') return 'Please enter a URL.';

       }

       // If too short
       if (validity.tooShort) return 'Please lengthen this text to ' + field.getAttribute('minLength') + ' characters or more. You are currently using ' + field.value.length + ' characters.';

       // If too long
       if (validity.tooLong) return 'Please shorten this text to no more than ' + field.getAttribute('maxLength') + ' characters. You are currently using ' + field.value.length + ' characters.';

       // If pattern doesn't match
       if (validity.patternMismatch) {

           // If pattern info is included, return custom error
           if (field.hasAttribute('title')) return field.getAttribute('title');

           // Otherwise, generic error
           return 'Please match the requested format.';

       }

       // If number input isn't a number
       if (validity.badInput) return 'Please enter a number.';

       // If a number value doesn't match the step interval
       if (validity.stepMismatch) return 'Please select a valid value.';

       // If a number field is over the max
       if (validity.rangeOverflow) return 'Please select a value that is no more than ' + field.getAttribute('max') + '.';

       // If a number field is below the min
       if (validity.rangeUnderflow) return 'Please select a value that is no less than ' + field.getAttribute('min') + '.';

       // If all else fails, return a generic catchall error
       return 'The value you entered for this field is invalid.';

   };


   // Show an error message
   var showError = function (field, error) {

       // Add error class to field
       field.classList.add('error');
   
       // If the field is a radio button and part of a group, error all and get the last item in the group
       if (field.type === 'radio' && field.name) {
           var group = field.form.querySelectorAll('[name="' + field.name + '"]');
           if (group.length > 0) {
               for (var i = 0; i < group.length; i++) {
                   group[i].classList.add('error');
               }
               field = group[group.length - 1];
           }
       }

       // Get field id or name
       var id = field.id || field.name;
       if (!id) return;

       // Check if error message field already exists
       // If not, create one
       var message = field.form.querySelector('.error-message#error-for-' + id );
       if (!message) {
           message = document.createElement('div');
           message.className = 'error-message';
           message.id = 'error-for-' + id;
           
           // If the field is a radio button or checkbox, insert error after the label
           var label;
           if (field.type === 'radio' || field.type ==='checkbox') {
               label = field.form.querySelector('label[for="' + id + '"]') || field.parentNode;
               if (label) {
                   label.parentNode.insertBefore( message, label.nextSibling );
               }
           }

           // Otherwise, insert it after the field
           if (!label) {
               field.parentNode.insertBefore( message, field.nextSibling );
           }

       }
       
       // Add ARIA role to the field
       field.setAttribute('aria-describedby', 'error-for-' + id);

       // Update error message
       message.innerHTML = error;

       // Show error message
       message.style.display = 'block';
       message.style.visibility = 'visible';

   };


   // Remove the error message
   var removeError = function (field) {

       // Remove error class to field
       field.classList.remove('error');
       
       // Remove ARIA role from the field
       field.removeAttribute('aria-describedby');

       // If the field is a radio button and part of a group, remove error from all and get the last item in the group
       if (field.type === 'radio' && field.name) {
           var group = field.form.querySelectorAll('[name="' + field.name + '"]');
           if (group.length > 0) {
               for (var i = 0; i < group.length; i++) {
                   group[i].classList.remove('error');
               }
               field = group[group.length - 1];
           }
       }

       // Get field id or name
       var id = field.id || field.name;
       if (!id) return;
       

       // Check if an error message is in the DOM
       var message = field.form.querySelector('.error-message#error-for-' + id + '');
       if (!message) return;

       // If so, hide it
       message.innerHTML = '';
       message.style.display = 'none';
       message.style.visibility = 'hidden';

   };


   // Listen to all blur events
   document.addEventListener('blur', function (event) {

       // Only run if the field is in a form to be validated
       if (!event.target.form.classList.contains('validate')) return;

       // Validate the field
       var error = hasError(event.target);
   
       // If there's an error, show it
       if (error) {
           showError(event.target, error);
           return;
       }

       // Otherwise, remove any existing error message
       removeError(event.target);

   }, true);


   // Check all fields on submit
   document.addEventListener('submit', function (event) {

       // Only run on forms flagged for validation
       if (!event.target.classList.contains('validate')) return;

       // Get all of the form elements
       var fields = event.target.elements;

       // Validate each field
       // Store the first field with an error to a variable so we can bring it into focus later
       var error, hasErrors;
       for (var i = 0; i < fields.length; i++) {
           error = hasError(fields[i]);
           if (error) {
               showError(fields[i], error);
               if (!hasErrors) {
                   hasErrors = fields[i];
               }
           }
       }

       // If there are errrors, don't submit form and focus on first element with error
       if (hasErrors) {
           event.preventDefault();
           hasErrors.focus();
       }

       // Otherwise, let the form submit normally
       // You could also bolt in an Ajax form submit process here

   }, false);
</script>
<!-- End of JavaScript Email Constraint Validation -->


<!-- Begin MailChimp Signup Form -->
<div id="mailchimp">
   <form action="https://ealizadeh.us10.list-manage.com/subscribe/post?u=912b9dacf23679bd0a6e46b22&amp;id=31485d9fc5" method="post" id="mc-embedded-subscribe-form" class="validate" style="max-width:450px;margin:auto" name="mc-embedded-subscribe-form" target="_blank" novalidate="">
       <!-- <i class="fa fa-envelope icon"> </i> -->    
       <h3 aria-hidden="true" class="fas fa-paper-plane mailinglist">Subscribe</h3>
           <!-- <div class="input-icons">  -->
                       <!-- <div class="input-icons">  -->
           <div class="clear">
               <i class="fa fa-envelope"> </i>
               <input class="required email" type="email" size="17" placeholder="E-mail Address" name="EMAIL" id="mce-EMAIL" title="The domain portion of the email address is invalid (the portion after the @)." pattern="^([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x22([^\x0d\x22\x5c\x80-\xff]|\x5c[\x00-\x7f])*\x22)(\x2e([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x22([^\x0d\x22\x5c\x80-\xff]|\x5c[\x00-\x7f])*\x22))*\x40([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x5b([^\x0d\x5b-\x5d\x80-\xff]|\x5c[\x00-\x7f])*\x5d)(\x2e([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x5b([^\x0d\x5b-\x5d\x80-\xff]|\x5c[\x00-\x7f])*\x5d))*(\.\w{2,})+$" required="">
           </div>
           <div class="clear">
               <i class="fa fa-user"> </i> 
               <input class="name" type="text" size="17" placeholder="Name (Optional)" name="FNAME" id="mce-FNAME">
           </div>

           <!-- <div class="footnote"> -->
               <p class="footnote"> No Spam. Unsubscribe anytime.</p>
           <!-- </div> -->
       <div id="mce-responses" class="clear">
           <div class="response" id="mce-error-response" style="display:none"></div>
           <div class="response" id="mce-success-response" style="display:none"></div>
       </div>
       
       <!-- <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_f2d244c0df42a0431bd08ddea_aeaa9dd034" tabindex="-1" value=""></div> -->
       <div class="clear">
           <input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button">
       </div>
   </form>
</div>
<!--End of MailChimp Signup Form-->
</div></div>
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a>
  <ul>
  <li><a href="#comparing-null-objects-vs.-is" id="toc-comparing-null-objects-vs.-is" class="nav-link" data-scroll-target="#comparing-null-objects-vs.-is"><strong>Comparing Null Objects (==&nbsp;vs.&nbsp;is )</strong></a></li>
  </ul></li>
  <li><a href="#finding-null-objects-in-pandas-numpy" id="toc-finding-null-objects-in-pandas-numpy" class="nav-link" data-scroll-target="#finding-null-objects-in-pandas-numpy">Finding null objects in Pandas &amp; NumPy</a></li>
  <li><a href="#calculations-with-missing-data" id="toc-calculations-with-missing-data" class="nav-link" data-scroll-target="#calculations-with-missing-data"><strong>Calculations with missing data</strong></a></li>
  <li><a href="#recommendations" id="toc-recommendations" class="nav-link" data-scroll-target="#recommendations">Recommendations</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  <li><a href="#useful-links" id="toc-useful-links" class="nav-link" data-scroll-target="#useful-links">Useful Links</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<p><img src="img/_featured_image.png" class="img-fluid" alt="Featured image of the post"></p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>üëâ This blog post was originally published my <a href="https://medium.com/@ealizadeh/working-with-missing-values-in-pandas-and-numpy-25b23a69ca02">medium blog</a>.</p>
</div>
</div>
<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>When working with data with missing values (aka NA or&nbsp;<em>not available</em>), we have to be careful about the operations we do. In this short article, we will look at different NA data types that someone may deal with when working with Pandas or NumPy libraries.</p>
<p>There are different null objects such as&nbsp;<strong>numpy.nan/numpy.NaN</strong>&nbsp;(Not a Number),&nbsp;<strong>pandas.NaT</strong>&nbsp;(Not a Time), or python‚Äôs&nbsp;<strong>None</strong>&nbsp;type object. Null objects may behave unexpectedly and result in a&nbsp;<a href="https://en.wikipedia.org/wiki/Logic_error">semantic error</a>&nbsp;(aka logic error) that is not easy to find or debug. Unlike&nbsp;<a href="https://en.wikipedia.org/wiki/Syntax_error">syntax errors</a>, your program will compile successfully even if there are semantic errors.</p>
<p><strong><em>In this article, we will go over the following items:</em></strong></p>
<ul>
<li><strong><em>Comparison of null objects (‚Äú==‚Äù vs ‚Äúis‚Äù)</em></strong></li>
<li><strong><em>Finding null objects in Pandas &amp; NumPy</em></strong></li>
<li><strong><em>Calculations with missing values</em></strong></li>
</ul>
<p><strong><em>NOTE: Data imputation/wrangling techniques are not a part of this article (a topic for a future article).</em></strong></p>
<hr>
<section id="comparing-null-objects-vs.-is" class="level3">
<h3 class="anchored" data-anchor-id="comparing-null-objects-vs.-is"><strong>Comparing Null Objects (==&nbsp;vs.&nbsp;is )</strong></h3>
<p>When comparing a Python object that may be NA, keep in mind the difference between the two Python‚Äôs equality operators: ‚Äú<strong><em>is</em></strong>‚Äùand ‚Äú<strong><em>==</em></strong>‚Äù. Python‚Äôs keyword ‚Äú<strong><em>is</em></strong>‚Äù compares the&nbsp;<em>identities</em>&nbsp;of two variables<em>,</em>&nbsp;while ‚Äú<strong><em>==</em></strong>‚Äù compares two variables by checking whether they are equal. Let‚Äôs see how these two differ.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="va">None</span> <span class="op">==</span> <span class="va">None</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># &gt;&gt;&gt; True</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="va">None</span> <span class="kw">is</span> <span class="va">None</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># &gt;&gt;&gt; True</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>When comparing Python‚Äôs <strong>None</strong> object, both ‚Äú<strong>==</strong>‚Äù and ‚Äú<strong>is</strong>‚Äù yield the same results. However, the output is different when <strong>numpy.nan</strong> null object is used!</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>numpy.nan <span class="op">==</span> numpy.nan</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># &gt;&gt;&gt; False</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>numpy.nan <span class="kw">is</span> numpy.nan</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># &gt;&gt;&gt; True</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This behavior may result in a semantic error, particularly if we do an element-wise comparison. For example, assume that we have</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> [<span class="fl">1.0</span>, np.nan, <span class="fl">2.0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>And we want to print a message on whether there is a missing value in the <strong>data</strong> or not.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using "==" in the element-wise comparison</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x <span class="kw">in</span> data:</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> x <span class="op">==</span> np.nan:</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Using '==' --&gt;  </span><span class="sc">{</span>x<span class="sc">}</span><span class="ss"> is a nan!"</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Using '==' --&gt;  </span><span class="sc">{</span>x<span class="sc">}</span><span class="ss"> is not a nan!"</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Using "is" in the element-wise comparison</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x <span class="kw">in</span> data:</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> x <span class="kw">is</span> np.nan:</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Using 'is' --&gt;  </span><span class="sc">{</span>x<span class="sc">}</span><span class="ss"> is a nan!"</span>)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Using 'is' --&gt;  </span><span class="sc">{</span>x<span class="sc">}</span><span class="ss"> is not a nan!"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>Using <span class="st">'=='</span> <span class="op">--&gt;</span>  <span class="fl">1.0</span> <span class="kw">is</span> <span class="kw">not</span> a nan<span class="op">!</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>Using <span class="st">'=='</span> <span class="op">--&gt;</span>  nan <span class="kw">is</span> <span class="kw">not</span> a nan<span class="op">!</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>Using <span class="st">'=='</span> <span class="op">--&gt;</span>  <span class="fl">2.0</span> <span class="kw">is</span> <span class="kw">not</span> a nan<span class="op">!</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>Using <span class="st">'is'</span> <span class="op">--&gt;</span>  <span class="fl">1.0</span> <span class="kw">is</span> <span class="kw">not</span> a nan<span class="op">!</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>Using <span class="st">'is'</span> <span class="op">--&gt;</span>  nan <span class="kw">is</span> a nan<span class="op">!</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>Using <span class="st">'is'</span> <span class="op">--&gt;</span>  <span class="fl">2.0</span> <span class="kw">is</span> <span class="kw">not</span> a nan<span class="op">!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>It is safer to use Pandas and/or NumPy‚Äôs built-in methods to check for missing values. We will cover this in the next section.</p>
</section>
</section>
<section id="finding-null-objects-in-pandas-numpy" class="level1">
<h1>Finding null objects in Pandas &amp; NumPy</h1>
<p>It is always safer to use NumPy or Pandas built-in methods to check for NAs. In NumPy, we can check for NaN entries by using&nbsp;<em><a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.isnan.html">numpy.isnan()</a></em>&nbsp;method. NumPy only supports its NaN objects and throws an error if we pass other null objects to numpy.<em>isnan()</em>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>numpy.isnan(np.nan)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># &gt;&gt;&gt; True</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>numpy.isnan(<span class="va">None</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># &gt;&gt;&gt; TypeError</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>I suggest you use <em>pandas.isna()</em> or its alias <em>pandas.isnull()</em> as they are more versatile than <em>numpy.isnan()</em> and accept other data objects and not only <em>numpy.nan</em>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pandas.isna() is an alias of pandas.isnull()</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>pandas.isna(np.nan)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># &gt;&gt;&gt; True</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>pandas.isna(<span class="va">None</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co"># &gt;&gt;&gt; True</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>pandas.isna(pd.NaT)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co"># &gt;&gt;&gt; True</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="calculations-with-missing-data" class="level1">
<h1><strong>Calculations with missing data</strong></h1>
<p>Let me tell you a story that happened to me a few days ago. I wanted to calculate the Median Absolute Deviation using&nbsp;<a href="https://www.statsmodels.org/dev/generated/statsmodels.robust.scale.mad.html">mad()</a>&nbsp;from the&nbsp;<a href="https://www.statsmodels.org/">statsmodel</a>&nbsp;library that is dependent on the&nbsp;<em>median()</em>&nbsp;function from NumPy. I had NaN entries in the data I was working on, and consequently, the output result was NaN since there was at least one missing value in the input array. It took me some time to find this semantic error. So, I figured the following out in a hard way:</p>
<div class="callout-warning callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Missing values propagate through arithmetic operations in NumPy and Pandas unless they are dropped or filled with a value.</p>
</div>
</div>
<p>The following examples illustrate what happens when we calculate some statistics from our data without considering the missing values:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="op">+</span> numpy.nan</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co"># &gt;&gt;&gt; nan</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>numpy.nan <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co"># &gt;&gt;&gt; nan</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>You have to be cautious about NaNs in your data when you are calculating any statistic. For example, let‚Äôs calculate the mean of an array including a NaN.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>numpy.mean([<span class="fl">1.0</span>, <span class="fl">2.0</span>, <span class="fl">3.0</span>, numpy.NaN])</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co"># &gt;&gt;&gt; nan</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>numpy.nanmean([<span class="fl">1.0</span>, <span class="fl">2.0</span>, <span class="fl">3.0</span>, numpy.NaN])</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co"># &gt;&gt;&gt; 2.0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>NumPy functions that calculate data statistics usually have counterpart functions to work with NaNs such as <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.nansum.html">numpy.nansum()</a> and <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.nanstd.html">numpy.nanstd()</a>.</p>
<hr>
</section>
<section id="recommendations" class="level1">
<h1>Recommendations</h1>
<ul>
<li>Always keep in mind the difference between equality operators ‚Äú<strong><em>==</em></strong>‚Äù and ‚Äú<strong><em>is</em></strong>‚Äù.</li>
<li>Use&nbsp;<em>Pandas</em>&nbsp;built-in methods to check for NA entries.</li>
<li>Pay attention to the behavior of functions in the presence of null objects, particularly functions to calculate statistical properties.</li>
</ul>
<hr>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p>I believe next time you work with null objects in Python, you pay more attention to them. I hope you learned something useful from my first ever article on <a href="http://medium.com/">Medium.com</a>. Feel free to provide me with any feedback or suggestion.</p>
<div class="callout callout callout-style-simple no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>üìì You can find a notebook for this article on <a href="https://github.com/e-alizadeh/medium/blob/master/notebooks/NotAvailable.ipynb">GitHub</a> that includes additional examples.</p>
</div>
</div>
</div>
</section>
<section id="useful-links" class="level1">
<h1>Useful Links</h1>
<p><a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/missing_data.html">Working with missing data - pandas 1.2.3 documentation</a></p>
<p><a href="https://dbader.org/blog/difference-between-is-and-equals-in-python">The Difference Between ‚Äúis‚Äù and ‚Äú==‚Äù in Python - dbader.org</a></p>


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{alizadeh2019,
  author = {Esmaeil Alizadeh},
  title = {Working with {Missing} {Values} in {Pandas} and {NumPy}},
  date = {2019-11-10},
  url = {https://new.ealizadeh.com/blog/working-with-missing-values-in-pandas-and-numpy},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-alizadeh2019" class="csl-entry quarto-appendix-citeas" role="doc-biblioentry">
Esmaeil Alizadeh. 2019. <span>‚ÄúWorking with Missing Values in Pandas and
NumPy.‚Äù</span> November 10, 2019. <a href="https://new.ealizadeh.com/blog/working-with-missing-values-in-pandas-and-numpy">https://new.ealizadeh.com/blog/working-with-missing-values-in-pandas-and-numpy</a>.
</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
      <div class="nav-footer-center">¬©Ô∏è 2022 Esmaeil Alizadeh - All Rights Reserved</div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/e-alizadeh">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/es_alizadeh">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>



<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>