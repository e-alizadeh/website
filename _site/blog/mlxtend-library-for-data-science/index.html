<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Essi">

<title>Essi Alizadeh – index</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../assets/favicon.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

<script type="text/javascript">

(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-180647948-1', 'auto');

ga('send', {
  hitType: 'pageview',
  'anonymizeIp': true,
});
</script>
<style>html{ scroll-behavior: smooth; }</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Essi Alizadeh</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html">Home</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blog.html">Blog</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">About</a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#mlxtend-a-python-library-with-interesting-tools-for-data-science-tasks" id="toc-mlxtend-a-python-library-with-interesting-tools-for-data-science-tasks" class="nav-link active" data-scroll-target="#mlxtend-a-python-library-with-interesting-tools-for-data-science-tasks">MLxtend: A Python Library with Interesting Tools for Data Science Tasks</a>
  <ul>
  <li><a href="#mlxtend-library" id="toc-mlxtend-library" class="nav-link" data-scroll-target="#mlxtend-library"><strong>MLxtend Library</strong></a></li>
  <li><a href="#dataset" id="toc-dataset" class="nav-link" data-scroll-target="#dataset"><strong>Dataset</strong></a></li>
  <li><a href="#mlxtend-functionalities" id="toc-mlxtend-functionalities" class="nav-link" data-scroll-target="#mlxtend-functionalities"><strong>MLxtend Functionalities</strong></a>
  <ul class="collapse">
  <li><a href="#create-counterfactual-for-model-interpretability" id="toc-create-counterfactual-for-model-interpretability" class="nav-link" data-scroll-target="#create-counterfactual-for-model-interpretability"><strong>Create Counterfactual (for model interpretability)</strong></a></li>
  <li><a href="#bias-variance-decomposition" id="toc-bias-variance-decomposition" class="nav-link" data-scroll-target="#bias-variance-decomposition"><strong>Bias-Variance Decomposition</strong></a></li>
  <li><a href="#plotting-decision-regions-of-classifiers" id="toc-plotting-decision-regions-of-classifiers" class="nav-link" data-scroll-target="#plotting-decision-regions-of-classifiers"><strong>Plotting Decision Regions of Classifiers</strong></a></li>
  <li><a href="#matrix-of-scatter-plots" id="toc-matrix-of-scatter-plots" class="nav-link" data-scroll-target="#matrix-of-scatter-plots"><strong>Matrix of Scatter Plots</strong></a></li>
  <li><a href="#bootstrapping" id="toc-bootstrapping" class="nav-link" data-scroll-target="#bootstrapping"><strong>Bootstrapping</strong></a></li>
  </ul></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  <li><a href="#join-my-mailing-list" id="toc-join-my-mailing-list" class="nav-link" data-scroll-target="#join-my-mailing-list"><strong>📩 Join my mailing list</strong></a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content">



<section id="mlxtend-a-python-library-with-interesting-tools-for-data-science-tasks" class="level1 page-columns page-full">
<h1>MLxtend: A Python Library with Interesting Tools for Data Science Tasks</h1>
<p>Created: March 8, 2021 8:42 PM Last Updated: July 17, 2021 Last updated: September 7, 2022 10:13 PM Reading Time: 6 min read Show on Homepage?: No Tags: Data Science, Exploratory Data Analysis, Machine Learning, Python, Python Library id: 9</p>
<aside>
<p>👉 <em>This article is also published on&nbsp;<a href="https://towardsdatascience.com/mlxtend-a-python-library-with-interesting-tools-for-data-science-tasks-d54c723f89cd">Towards Data Science Blog</a>.</em></p>
</aside>
<ul>
<li><strong>Table of Content</strong></li>
</ul>
<p><a href="https://rasbt.github.io/mlxtend/">MLxtend</a>&nbsp;library (Machine Learning extensions) has many interesting functions for everyday data analysis and machine learning tasks. Although there are many machine learning libraries available for Python such as&nbsp;<a href="https://scikit-learn.org/">scikit-learn</a>,&nbsp;<a href="https://www.tensorflow.org/">TensorFlow</a>,&nbsp;<a href="https://keras.io/">Keras</a>,&nbsp;<a href="https://pytorch.org/">PyTorch</a>,&nbsp;<em>etc</em>, however, MLxtend offers additional functionalities and can be a valuable addition to your data science toolbox.</p>
<p>In this post, I will go over several tools of the library, in particular, I will cover:</p>
<ul>
<li>Create counterfactual (for model interpretability)</li>
<li>PCA correlation circle</li>
<li>Bias-variance decomposition</li>
<li>Decision regions of classification models</li>
<li>Matrix of scatter plots</li>
<li>Bootstrapping</li>
<li></li>
</ul>
<p>For a list of all functionalities this library offers, you can visit MLxtend’s&nbsp;<a href="https://rasbt.github.io/mlxtend/">documentation</a>[1].</p>
<p>👉 <em>A link to a free one-page summary of this post is available at the end of the post.</em></p>
<hr>
<section id="mlxtend-library" class="level2">
<h2 class="anchored" data-anchor-id="mlxtend-library"><strong>MLxtend Library</strong></h2>
<p>MLxtend library is developed by&nbsp;<a href="https://sebastianraschka.com/">Sebastian Raschka</a>&nbsp;(a professor of statistics at the University of Wisconsin-Madison). The library has nice API documentation as well as many examples.</p>
<p>You can install the MLxtend package through the Python Package Index (PyPi) by running</p>
<p><code>pip install mlxtend</code>.</p>
</section>
<section id="dataset" class="level2">
<h2 class="anchored" data-anchor-id="dataset"><strong>Dataset</strong></h2>
<p>In this post, I’m using the wine data set obtained from the&nbsp;<a href="https://www.kaggle.com/tug004/3wine-classification-dataset">Kaggle</a>. The data contains 13 attributes of alcohol for three types of wine. This is a multiclass classification dataset, and you can find the description of the dataset&nbsp;<a href="https://archive.ics.uci.edu/ml/datasets/wine">here</a>.</p>
<p>First, let’s import the data and prepare the input variables&nbsp;<span class="math inline">X</span>&nbsp;(feature set) and the output variable&nbsp;<span class="math inline">y</span>&nbsp;(target).</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Load wine data set (available at https://www.kaggle.com/tug004/3wine-classification-dataset)</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">"./data/wine.csv"</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Target values (wine classes) in y</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>y_s <span class="op">=</span> df[<span class="st">"Wine"</span>].<span class="bu">map</span>({<span class="dv">1</span>: <span class="dv">0</span>, <span class="dv">2</span>: <span class="dv">1</span>, <span class="dv">3</span>: <span class="dv">2</span>})  <span class="co"># Convert classes 1, 2, 3 to 0, 1, 2 to avoid strange behavior </span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> y_s.values</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Feature columns </span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>X_df <span class="op">=</span> df.drop(columns<span class="op">=</span>[<span class="st">"Wine"</span>])</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> X_df.values</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>attribute_names <span class="op">=</span> X_df.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="mlxtend-functionalities" class="level2">
<h2 class="anchored" data-anchor-id="mlxtend-functionalities"><strong>MLxtend Functionalities</strong></h2>
<section id="create-counterfactual-for-model-interpretability" class="level3">
<h3 class="anchored" data-anchor-id="create-counterfactual-for-model-interpretability"><strong>Create Counterfactual (for model interpretability)</strong></h3>
<p>For creating counterfactual records (in the context of machine learning), we need to modify the features of some records from the training set in order to change the model prediction[2]. This may be helpful in explaining the behavior of a trained model. The algorithm used in the library to create counterfactual records is developed by Wachter&nbsp;<em>et al</em>[3].</p>
<p>You can create counterfactual records using&nbsp;<em><a href="https://rasbt.github.io/mlxtend/user_guide/evaluate/create_counterfactual/">create_counterfactual()</a></em>&nbsp;from the library. Note that this implementation works with any scikit-learn estimator that supports the&nbsp;<code>predict()</code>&nbsp;function. Below is an example of creating a counterfactual record for an ML model. The counterfactual record is highlighted in a red dot within the classifier’s decision regions (we will go over how to draw decision regions of classifiers later in the post).</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>clf_logistic_regression <span class="op">=</span> LogisticRegression(random_state<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>clf_logistic_regression.fit(X_2d, y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> mlxtend.evaluate <span class="im">import</span> create_counterfactual</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> mlxtend.plotting <span class="im">import</span> plot_decision_regions</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>counterfact <span class="op">=</span> create_counterfactual(</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    x_reference<span class="op">=</span>X_2d[<span class="dv">15</span>], </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    y_desired<span class="op">=</span><span class="dv">2</span>, <span class="co"># Desired class</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    model<span class="op">=</span>clf_logistic_regression, </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    X_dataset<span class="op">=</span>X_2d,</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    y_desired_proba<span class="op">=</span><span class="fl">0.95</span>,</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    lammbda<span class="op">=</span><span class="dv">1</span>, </span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    random_seed<span class="op">=</span><span class="dv">123</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>scatter_highlight_defaults <span class="op">=</span> {</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">'c'</span>: <span class="st">'red'</span>,</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">'edgecolor'</span>: <span class="st">'yellow'</span>,</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">'alpha'</span>: <span class="fl">1.0</span>,</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">'linewidths'</span>: <span class="dv">2</span>,</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">'marker'</span>: <span class="st">'o'</span>,</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">'s'</span>: <span class="dv">120</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>plot_decision_regions(X_2d, y, clf<span class="op">=</span>clf_logistic_regression, legend<span class="op">=</span><span class="dv">2</span>, ax<span class="op">=</span>ax)</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>ax.tick_params(axis<span class="op">=</span><span class="st">'both'</span>, which<span class="op">=</span><span class="st">'major'</span>, labelsize<span class="op">=</span><span class="dv">24</span>)</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">"Create a Counterfactual Record"</span>, fontsize<span class="op">=</span><span class="dv">24</span>, fontweight<span class="op">=</span><span class="st">"bold"</span>)</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">"Color.int"</span>, fontsize<span class="op">=</span><span class="dv">20</span>, fontweight<span class="op">=</span><span class="st">"bold"</span>)</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">"Phenols"</span>, fontsize<span class="op">=</span><span class="dv">20</span>, fontweight<span class="op">=</span><span class="st">"bold"</span>)</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>ax.scatter(</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>    <span class="op">*</span>counterfact,</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>    <span class="op">**</span>scatter_highlight_defaults</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="MLxtend%20A%20Python%20Library%20with%20Interesting%20Tools%20fo%20264ef2d64cce4a179cc8263b7c027dd3/bp09_counterfactual_instance.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">A counterfactual record is highlighted within a classifier’s decision region</figcaption><p></p>
</figure>
</div>
<p>A counterfactual record is highlighted within a classifier’s decision region</p>
<p><strong>PCA Correlation Circle</strong></p>
<p>An interesting and different way to look at PCA results is through a correlation circle that can be plotted using&nbsp;<em><a href="https://rasbt.github.io/mlxtend/user_guide/plotting/plot_pca_correlation_graph/">plot_pca_correlation_graph()</a></em>. We basically compute the correlation between the original dataset columns and the PCs (principal components). Then, these correlations are plotted as vectors on a unit-circle. The axes of the circle are the selected dimensions (<em>a.k.a.</em>&nbsp;PCs). You can specify the PCs you’re interested in by passing them as a tuple to&nbsp;<code>dimensions</code> function argument. The correlation circle axes labels show the percentage of the&nbsp;<a href="https://en.wikipedia.org/wiki/Explained_variation">explained variance</a>&nbsp;for the corresponding PC[1].</p>
<p>Remember that the normalization is important in PCA because the PCA projects the original data on to the directions that maximize the variance.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> mlxtend.plotting <span class="im">import</span> plot_pca_correlation_graph</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>X_norm <span class="op">=</span> StandardScaler().fit_transform(X) <span class="co"># Normalizing the feature columns is recommended (X - mean) / std</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>fig, correlation_matrix <span class="op">=</span> plot_pca_correlation_graph(</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    X_norm, </span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    attribute_names,</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    dimensions<span class="op">=</span>(<span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    figure_axis_size<span class="op">=</span><span class="dv">6</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="MLxtend%20A%20Python%20Library%20with%20Interesting%20Tools%20fo%20264ef2d64cce4a179cc8263b7c027dd3/bp09_correlation_circle_dim1_vs_dim2.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">PCA correlation circle diagram between the first two principal components and all data attributes</figcaption><p></p>
</figure>
</div>
<p>PCA correlation circle diagram between the first two principal components and all data attributes</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="MLxtend%20A%20Python%20Library%20with%20Interesting%20Tools%20fo%20264ef2d64cce4a179cc8263b7c027dd3/bp09_pca_correlation_matrix.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Correlation matrix between wine features and the first two PCs</figcaption><p></p>
</figure>
</div>
<p>Correlation matrix between wine features and the first two PCs</p>
</section>
<section id="bias-variance-decomposition" class="level3">
<h3 class="anchored" data-anchor-id="bias-variance-decomposition"><strong>Bias-Variance Decomposition</strong></h3>
<p>You often hear about the bias-variance tradeoff to show the model performance. In supervised learning, the goal often is to minimize both the bias error (to prevent underfitting) and variance (to prevent overfitting) so that our model can generalize beyond the training set[4]. This process is known as a bias-variance tradeoff.</p>
<p>Note that we cannot calculate the actual bias and variance for a predictive model, and the bias-variance tradeoff is a concept that an ML engineer should always consider and tries to find a sweet spot between the two.Having said that, we can still study the model’s expected generalization error for certain problems. In particular, we can use the bias-variance decomposition to decompose the generalization error into a sum of 1) bias, 2) variance, and 3)&nbsp;<em>irreducible error</em>[4,5].</p>
<p>The bias-variance decomposition can be implemented through&nbsp;<em><a href="https://rasbt.github.io/mlxtend/user_guide/evaluate/bias_variance_decomp/">bias_variance_decomp()</a></em>&nbsp;in the library. An example of such implementation for a decision tree classifier is given below.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeClassifier</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X_df.values, y,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>                                                    test_size<span class="op">=</span><span class="fl">0.3</span>,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>                                                    random_state<span class="op">=</span><span class="dv">123</span>,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>                                                    shuffle<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>                                                    stratify<span class="op">=</span>y)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>tree <span class="op">=</span> DecisionTreeClassifier(random_state<span class="op">=</span><span class="dv">123</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> mlxtend.evaluate <span class="im">import</span> bias_variance_decomp</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>avg_expected_loss, avg_bias, avg_var <span class="op">=</span> bias_variance_decomp(</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>        tree, X_train, y_train, X_test, y_test, </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>        loss<span class="op">=</span><span class="st">'mse'</span>,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>        num_rounds<span class="op">=</span><span class="dv">50</span>, <span class="co"># Number of bootstrap rounds for implementing the decomposition</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>        random_seed<span class="op">=</span><span class="dv">123</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Average expected loss: </span><span class="sc">{</span>avg_expected_loss<span class="sc">.</span><span class="bu">round</span>(<span class="dv">3</span>)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Average bias: </span><span class="sc">{</span>avg_bias<span class="sc">.</span><span class="bu">round</span>(<span class="dv">3</span>)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Average variance: </span><span class="sc">{</span>avg_var<span class="sc">.</span><span class="bu">round</span>(<span class="dv">3</span>)<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> Average expected loss: <span class="fl">0.108</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> Average bias: <span class="fl">0.032</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> Average variance: <span class="fl">0.076</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="plotting-decision-regions-of-classifiers" class="level3">
<h3 class="anchored" data-anchor-id="plotting-decision-regions-of-classifiers"><strong>Plotting Decision Regions of Classifiers</strong></h3>
<p>MLxtend library has an out-of-the-box function&nbsp;<em><a href="https://rasbt.github.io/mlxtend/user_guide/plotting/plot_decision_regions/">plot_decision_regions()</a></em>&nbsp;to draw a classifier’s decision regions in 1 or 2 dimensions.</p>
<p>Here, I will draw decision regions for several scikit-learn as well as MLxtend models. Let’s first import the models and initialize them.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Models</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.naive_bayes <span class="im">import</span> GaussianNB </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> mlxtend.classifier <span class="im">import</span> EnsembleVoteClassifier </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Initializing Classifiers</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>clf_logistic_regression <span class="op">=</span> LogisticRegression(random_state<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>clf_nb <span class="op">=</span> GaussianNB()</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>clf_random_forest <span class="op">=</span> RandomForestClassifier(random_state<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>clf_ensemble <span class="op">=</span> EnsembleVoteClassifier(</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>    clfs<span class="op">=</span>[clf_logistic_regression, clf_nb, clf_random_forest], </span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>    weights<span class="op">=</span>[<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>], </span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>    voting<span class="op">=</span><span class="st">'soft'</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>all_classifiers <span class="op">=</span> [</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>    (<span class="st">"Logistic Regression"</span>, clf_logistic_regression),</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>    (<span class="st">"Naive Bayes"</span>, clf_nb),</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>    (<span class="st">"Random Forest"</span>, clf_random_forest),</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>    (<span class="st">"Ensemble"</span>, clf_ensemble),</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Now that we have initialized all the classifiers, let’s train the models and draw decision boundaries using <a href="https://rasbt.github.io/mlxtend/user_guide/plotting/plot_decision_regions/"><em>plot_decision_regions()</em></a> from the MLxtend library.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> mlxtend.plotting <span class="im">import</span> plot_decision_regions</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> product  <span class="co"># Used to generate indices for figure subplots!</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>fig, axs <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">28</span>, <span class="dv">24</span>), sharey<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> classifier, grid <span class="kw">in</span> <span class="bu">zip</span>(</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    all_classifiers,</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    product([<span class="dv">0</span>, <span class="dv">1</span>], [<span class="dv">0</span>, <span class="dv">1</span>])  <span class="co"># generate [(0, 0), (0, 1), (1, 0), (1, 1)]</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    clf_name, clf <span class="op">=</span> classifier[<span class="dv">0</span>], classifier[<span class="dv">1</span>]</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    ax <span class="op">=</span> axs[grid[<span class="dv">0</span>], grid[<span class="dv">1</span>]]</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    clf.fit(X_2d, y)</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    plot_decision_regions(</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>        X<span class="op">=</span>X_2d, </span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span>y, </span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>        clf<span class="op">=</span>clf, </span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>        legend<span class="op">=</span><span class="dv">2</span>, </span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>        ax<span class="op">=</span>ax</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>    ax.set_title(clf_name, fontsize<span class="op">=</span><span class="dv">24</span>, fontweight<span class="op">=</span><span class="st">"bold"</span>)</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>    ax.tick_params(axis<span class="op">=</span><span class="st">'both'</span>, which<span class="op">=</span><span class="st">'major'</span>, labelsize<span class="op">=</span><span class="dv">18</span>)</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(<span class="st">"Color.int"</span>, fontsize<span class="op">=</span><span class="dv">20</span>, fontweight<span class="op">=</span><span class="st">"bold"</span>)</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(<span class="st">"Phenols"</span>, fontsize<span class="op">=</span><span class="dv">20</span>, fontweight<span class="op">=</span><span class="st">"bold"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="MLxtend%20A%20Python%20Library%20with%20Interesting%20Tools%20fo%20264ef2d64cce4a179cc8263b7c027dd3/bp09_all_classifiers_decision_regions.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Decision regions of all classifiers</figcaption><p></p>
</figure>
</div>
<p>Decision regions of all classifiers</p>
</section>
<section id="matrix-of-scatter-plots" class="level3">
<h3 class="anchored" data-anchor-id="matrix-of-scatter-plots"><strong>Matrix of Scatter Plots</strong></h3>
<p>Another useful tool from MLxtend is the ability to draw a matrix of scatter plots for features (using&nbsp;<em><a href="https://rasbt.github.io/mlxtend/user_guide/plotting/scatterplotmatrix/">scatterplotmatrix()</a></em>). In order to add another dimension to the scatter plots, we can also assign different colors for different target classes.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> mlxtend.plotting <span class="im">import</span> scatterplotmatrix</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> scatterplotmatrix(X[y<span class="op">==</span><span class="dv">0</span>], figsize<span class="op">=</span>(<span class="dv">34</span>, <span class="dv">30</span>), alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> scatterplotmatrix(X[y<span class="op">==</span><span class="dv">1</span>], fig_axes<span class="op">=</span>(fig, axes), alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> scatterplotmatrix(X[y<span class="op">==</span><span class="dv">2</span>], fig_axes<span class="op">=</span>(fig, axes), alpha<span class="op">=</span><span class="fl">0.5</span>, names<span class="op">=</span>attribute_names)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="MLxtend%20A%20Python%20Library%20with%20Interesting%20Tools%20fo%20264ef2d64cce4a179cc8263b7c027dd3/bp09_matrix_scatter_plots.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">A matrix of scatter plot of all wine attributes with different colors for wine types</figcaption><p></p>
</figure>
</div>
<p>A matrix of scatter plot of all wine attributes with different colors for wine types</p>
<p>By the way, for plotting similar scatter plots, you can also use Pandas’ <em><a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.plotting.scatter_matrix.html">scatter_matrix()</a></em> or seaborn’s <em><a href="https://seaborn.pydata.org/generated/seaborn.pairplot.html">pairplot()</a></em> function.</p>
</section>
<section id="bootstrapping" class="level3">
<h3 class="anchored" data-anchor-id="bootstrapping"><strong>Bootstrapping</strong></h3>
<p>The&nbsp;<a href="https://en.wikipedia.org/wiki/Bootstrapping_(statistics)">bootstrap</a>&nbsp;is an easy way to estimate a sample statistic and generate the corresponding confidence interval by drawing&nbsp;<a href="https://en.wikipedia.org/wiki/Sampling_(statistics)#Replacement_of_selected_units">random samples with replacement</a>. For this, you can use the&nbsp;<em><a href="https://rasbt.github.io/mlxtend/user_guide/evaluate/bootstrap/">bootstrap()</a></em>&nbsp;function from the library. Note that you can pass a custom statistic to the bootstrap function through argument&nbsp;<code>func</code>. The custom function must return a scalar value.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> mlxtend.evaluate <span class="im">import</span> bootstrap</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Generating 100 random data with a mean of 5</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>random_data <span class="op">=</span> np.random.RandomState(<span class="dv">123</span>).normal(loc<span class="op">=</span><span class="fl">5.</span>, size<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>avg, std_err, ci_bounds <span class="op">=</span> bootstrap(</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    random_data, </span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    num_rounds<span class="op">=</span><span class="dv">1000</span>, </span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    func<span class="op">=</span>np.mean,  <span class="co"># A function to compute a sample statistic can be passed here</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    ci<span class="op">=</span><span class="fl">0.95</span>, </span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    seed<span class="op">=</span><span class="dv">123</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>    <span class="ss">f"Mean: </span><span class="sc">{</span>avg<span class="sc">.</span><span class="bu">round</span>(<span class="dv">2</span>)<span class="sc">}</span><span class="ss"> </span><span class="ch">\n</span><span class="ss">"</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>    <span class="ss">f"Standard Error: +/- </span><span class="sc">{</span>std_err<span class="sc">.</span><span class="bu">round</span>(<span class="dv">2</span>)<span class="sc">}</span><span class="ss"> </span><span class="ch">\n</span><span class="ss">"</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>    <span class="ss">f"CI95: [</span><span class="sc">{</span>ci_bounds[<span class="dv">0</span>]<span class="sc">.</span><span class="bu">round</span>(<span class="dv">2</span>)<span class="sc">}</span><span class="ss">, </span><span class="sc">{</span>ci_bounds[<span class="dv">1</span>]<span class="sc">.</span><span class="bu">round</span>(<span class="dv">2</span>)<span class="sc">}</span><span class="ss">]"</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> Mean: <span class="fl">5.03</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> Standard Error: <span class="op">+/-</span> <span class="fl">0.11</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> CI95: [<span class="fl">4.8</span>, <span class="fl">5.26</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
</section>
<section id="conclusion" class="level1 page-columns page-full">
<h1>Conclusion</h1>
<p>In this post, we went over several MLxtend library functionalities, in particular, we talked about creating counterfactual instances for better model interpretability and plotting decision regions for classifiers, drawing PCA correlation circle, analyzing bias-variance tradeoff through decomposition, drawing a matrix of scatter plots of features with colored targets, and implementing the bootstrapping. The library is a nice addition to your data science toolbox, and I recommend giving this library a try.</p>
<aside>
<p>📓 You can find the Jupyter notebook for this blog post on <a href="https://github.com/e-alizadeh/medium/blob/master/notebooks/MLxtend.ipynb">GitHub</a>.</p>
</aside>
<p><strong>One-Page Summary</strong></p>
<p><a href="MLxtend%20A%20Python%20Library%20with%20Interesting%20Tools%20fo%20264ef2d64cce4a179cc8263b7c027dd3/mlxtend-one-page-summary.pdf">MLxtend%20A%20Python%20Library%20with%20Interesting%20Tools%20fo%20264ef2d64cce4a179cc8263b7c027dd3/mlxtend-one-page-summary.pdf</a></p>
<hr>
<p><strong>Thanks for reading 🙏</strong></p>
<p><em>If you liked this post, you can join my mailing list to receive similar posts. You can follow me on <a href="https://www.linkedin.com/in/alizadehesmaeil/">LinkedIn</a>, <a href="https://github.com/e-alizadeh">GitHub</a>, <a href="https://twitter.com/intent/follow?screen_name=es_alizadeh&amp;tw_p=followbutton">Twitter</a> and <a href="https://medium.com/@ealizadeh">Medium</a>.</em></p>
<p><em>And finally, you can find my knowledge forest 🌲 (raw digital notes) at <a href="https://notes.ealizadeh.com/">notes.ealizadeh.com</a>.</em></p>
</section>
<section id="join-my-mailing-list" class="level1">
<h1><strong>📩 Join my mailing list</strong></h1>
<p><a href="https://chilipepper.io/form/burning-darkcrimson-piquillo-fcdff002-5e7b-4d46-a75e-6290908a51f4">https://chilipepper.io/form/burning-darkcrimson-piquillo-fcdff002-5e7b-4d46-a75e-6290908a51f4</a></p>
<hr>
</section>
<section id="references" class="level1">
<h1>References</h1>
<p>[1] Sebastian Raschka,&nbsp;<a href="https://rasbt.github.io/mlxtend/">MLxtend</a></p>
<p>[2] Sebastian Raschka,&nbsp;<a href="https://rasbt.github.io/mlxtend/user_guide/evaluate/create_counterfactual/">Create Counterfactual</a>, MLxtend API documentation</p>
<p>[3] S. Wachter&nbsp;<em>et al</em>&nbsp;(2018),&nbsp;<a href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3063289">Counterfactual Explanations without Opening the Black Box: Automated Decisions and the GDPR</a>, 31(2), Harvard Journal of Law &amp; Technology</p>
<p>[4] Wikipedia,&nbsp;<a href="https://en.wikipedia.org/wiki/Bias-variance_tradeoff">Bias–variance tradeoff</a></p>
<p>[5] Sebastian Raschka,&nbsp;<a href="https://rasbt.github.io/mlxtend/user_guide/evaluate/bias_variance_decomp/">Bias-Variance Decomposition</a>, MLxtend API documentation</p>
<hr>
<p>⬅️ <strong>Previous Post</strong></p>
<p><a href="MLxtend%20A%20Python%20Library%20with%20Interesting%20Tools%20fo%20264ef2d64cce4a179cc8263b7c027dd3/Blog%20Posts%20dcc0d4c69e054266bdb839a1838b8e6e.csv">Blog Posts</a></p>
<p><strong>➡️ Next Post</strong></p>
<p><a href="MLxtend%20A%20Python%20Library%20with%20Interesting%20Tools%20fo%20264ef2d64cce4a179cc8263b7c027dd3/Blog%20Posts%20417f7ebd27c54596bd58a6c5aad3c79d.csv">Blog Posts</a></p>


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{essi,
  author = {Essi},
  editor = {},
  url = {https://ealizadeh.com/blog/mlxtend-library-for-data-science},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-essi" class="csl-entry quarto-appendix-citeas" role="doc-biblioentry">
Essi. n.d. <a href="https://ealizadeh.com/blog/mlxtend-library-for-data-science">https://ealizadeh.com/blog/mlxtend-library-for-data-science</a>.
</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
      <div class="nav-footer-center">©️ 2022 Esmaeil Alizadeh - All Rights Reserved</div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/e-alizadeh">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/es_alizadeh">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>



<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>